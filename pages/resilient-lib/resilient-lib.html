<!doctype html>
<html class="no-js" lang="en" data-content_root="../../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="search" title="Search" href="../../search.html" /><link rel="next" title="resilient-sdk" href="../resilient-sdk/resilient-sdk.html" /><link rel="prev" title="resilient-circuits" href="../resilient-circuits/resilient-circuits.html" />

    <link rel="shortcut icon" href="../../_static/IBM_Security_Shield.ico"/><!-- Generated with Sphinx 7.3.7 and Furo 2024.05.06 -->
        <title>resilient-lib - IBM SOAR Python Documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?v=387cc868" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?v=36a5483c" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" /
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">IBM SOAR Python Documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../../_static/IBM_Security_Light.png" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../../_static/IBM_Security_Dark.png" alt="Dark Logo"/>
  </div>
  
  <span class="sidebar-brand-text">IBM SOAR Python Documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../resilient/resilient.html">resilient</a></li>
<li class="toctree-l1"><a class="reference internal" href="../resilient-circuits/resilient-circuits.html">resilient-circuits</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">resilient-lib</a></li>
<li class="toctree-l1"><a class="reference internal" href="../resilient-sdk/resilient-sdk.html">resilient-sdk</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          

<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="resilient-lib">
<h1>resilient-lib<a class="headerlink" href="#resilient-lib" title="Link to this heading">¶</a></h1>
<p>Python module with library calls which facilitate the development of Apps for IBM SOAR</p>
<section id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Link to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">resilient-lib</span></code> is now a direct dependency of <code class="docutils literal notranslate"><span class="pre">resilient-circuits</span></code> as of <strong>v40.0</strong> to help make development more streamlined</p>
<p>It can also be installed directly with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ pip install resilient-lib
</pre></div>
</div>
<p>To use it within your App development, <strong>import</strong> it like any other Python Package:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">resilient_lib</span> <span class="kn">import</span> <span class="n">readable_datetime</span>

<span class="n">created_date</span> <span class="o">=</span> <span class="n">readable_datetime</span><span class="p">(</span><span class="n">fn_inputs</span><span class="o">.</span><span class="n">inc_create_date</span><span class="p">,</span> <span class="n">rtn_format</span><span class="o">=</span><span class="s2">&quot;%m-</span><span class="si">%d</span><span class="s2">-%Y %H:%M:%S&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="proxies">
<h2>Proxies<a class="headerlink" href="#proxies" title="Link to this heading">¶</a></h2>
<p>You can now take advantage of the global proxy functionality.
There is no need to add an <code class="docutils literal notranslate"><span class="pre">[integrations]</span></code> section like below.
Run the following on your App Host for more information:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ manageAppHost proxy -h
</pre></div>
</div>
<p><em>The hierarchy of proxies is as follows:</em></p>
<ol class="arabic simple">
<li><p><strong>RequestsCommon.execute() Function:</strong> the <code class="docutils literal notranslate"><span class="pre">proxies</span></code> parameter.</p></li>
<li><p><strong>Environmental Variables:</strong> <code class="docutils literal notranslate"><span class="pre">HTTPS_PROXY</span></code>, <code class="docutils literal notranslate"><span class="pre">HTTP_PROXY</span></code> and <code class="docutils literal notranslate"><span class="pre">NO_PROXY</span></code> set
using the <code class="docutils literal notranslate"><span class="pre">manageAppHost</span> <span class="pre">proxy</span></code> command on the App Host.</p></li>
<li><p><strong>Function Options:</strong> <code class="docutils literal notranslate"><span class="pre">http_proxy</span></code> or <code class="docutils literal notranslate"><span class="pre">https_proxy</span></code> configs set in the
<strong>Function Section</strong> (<code class="docutils literal notranslate"><span class="pre">[my_function]</span></code>) of your app.config file.</p></li>
<li><p><strong>Integrations Options:</strong> <code class="docutils literal notranslate"><span class="pre">http_proxy</span></code> or <code class="docutils literal notranslate"><span class="pre">https_proxy</span></code> configs set in the
<strong>Integrations Section</strong> (<code class="docutils literal notranslate"><span class="pre">[integrations]</span></code>) of your app.config file.</p></li>
</ol>
<p>If using a version of App Host earlier than 1.6, <code class="docutils literal notranslate"><span class="pre">resilient-lib</span></code> supports an <code class="docutils literal notranslate"><span class="pre">[integrations]</span></code> section in your app.config file.
Add this section to define proxy settings to be used for all integrations that use this library.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">integrations</span><span class="p">]</span>
<span class="n">verify</span><span class="o">=</span><span class="kc">True</span>
<span class="c1"># These proxy settings will be used by all integrations.</span>
<span class="c1"># To override, add any parameter to your specific integration section</span>
<span class="n">http_proxy</span><span class="o">=</span>
<span class="n">https_proxy</span><span class="o">=</span>
<span class="n">timeout</span><span class="o">=</span><span class="mi">30</span>
</pre></div>
</div>
</section>
<section id="certificate-verification">
<h2>Certificate Verification<a class="headerlink" href="#certificate-verification" title="Link to this heading">¶</a></h2>
<p>You can now take advantage of the global verify functionality.
Valid options for <code class="docutils literal notranslate"><span class="pre">verify</span></code> are True, False, or a path to a
valid certificate chain file. The default (and suggested value)
is <code class="docutils literal notranslate"><span class="pre">True</span></code> which will use the default Python CA bundle found at
<code class="docutils literal notranslate"><span class="pre">REQUESTS_CA_BUNDLE</span></code>.</p>
<p><em>The hierarchy of proxies is as follows:</em></p>
<ol class="arabic simple">
<li><p><strong>RequestsCommon.execute() Function:</strong> the <code class="docutils literal notranslate"><span class="pre">verify</span></code> parameter.</p></li>
<li><p><strong>Function Options:</strong> <code class="docutils literal notranslate"><span class="pre">verify</span></code> config set in the
<strong>Function Section</strong> (<code class="docutils literal notranslate"><span class="pre">[my_function]</span></code>) of your app.config file.</p></li>
<li><p><strong>Integrations Options:</strong> <code class="docutils literal notranslate"><span class="pre">verify</span></code> config set in the
<strong>Integrations Section</strong> (<code class="docutils literal notranslate"><span class="pre">[integrations]</span></code>) of your app.config file.</p></li>
</ol>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">my_function</span><span class="p">]</span>
<span class="n">verify</span><span class="o">=/</span><span class="n">var</span><span class="o">/</span><span class="n">rescircuits</span><span class="o">/</span><span class="n">cafile</span><span class="o">.</span><span class="n">pem</span>
<span class="n">http_proxy</span><span class="o">=</span>
<span class="n">https_proxy</span><span class="o">=</span>
<span class="n">timeout</span><span class="o">=</span><span class="mi">30</span>
</pre></div>
</div>
</section>
<section id="module-resilient_lib.components.resilient_common">
<span id="common-helper-methods"></span><h2>Common Helper Methods<a class="headerlink" href="#module-resilient_lib.components.resilient_common" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="resilient_lib.components.resilient_common.build_incident_url">
<span class="sig-name descname"><span class="pre">build_incident_url</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">url</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">incidentId</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orgId</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#resilient_lib.components.resilient_common.build_incident_url" title="Link to this definition">¶</a></dt>
<dd><p>Build the url to link to a SOAR incident or CP4S case.
Add <code class="docutils literal notranslate"><span class="pre">https</span></code> if http/https is not provided at the start.
If <code class="docutils literal notranslate"><span class="pre">url</span></code> is not a string, returns back the value given.</p>
<p><code class="docutils literal notranslate"><span class="pre">orgId</span></code> is optional to maintain backward compatibility, however, it is
strongly recommended to provide the organization ID of the incident
so that links work without unexpected hiccups when multiple orgs are
available on your SOAR instance</p>
<p>Returns a URL in the format <code class="docutils literal notranslate"><span class="pre">https://&lt;url&gt;/#&lt;incident_id&gt;?orgId=&lt;orgId&gt;</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>url</strong> (<em>str</em>) – the URL of your SOAR instance</p></li>
<li><p><strong>incidentId</strong> (<em>str</em><em>|</em><em>int</em>) – the id of the incident</p></li>
<li><p><strong>orgId</strong> (<em>str</em><em>|</em><em>int</em><em>|</em><em>None</em>) – (optional) the id of the org the incident lives in. If the user is logged into a different org
and this is not set, the link produced may direct the user to a different incident resulting in
unexpected results</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>full URL to the incident</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="resilient_lib.components.resilient_common.build_resilient_url">
<span class="sig-name descname"><span class="pre">build_resilient_url</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">host</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">port</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#resilient_lib.components.resilient_common.build_resilient_url" title="Link to this definition">¶</a></dt>
<dd><p>Build basic url to SOAR/CP4S instance.
Add ‘https’ if http/https is not provided at the start.
If <code class="docutils literal notranslate"><span class="pre">host</span></code> is not a string, returns back the value given.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>host</strong> (<em>str</em>) – host name</p></li>
<li><p><strong>port</strong> (<em>str</em><em>|</em><em>int</em>) – port</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>base url</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="resilient_lib.components.resilient_common.build_task_url">
<span class="sig-name descname"><span class="pre">build_task_url</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">url</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">incident_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">org_id</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#resilient_lib.components.resilient_common.build_task_url" title="Link to this definition">¶</a></dt>
<dd><p>Build the url to link to a SOAR/CP4S task.
Add <code class="docutils literal notranslate"><span class="pre">https</span></code> if http/https is not provided at the start.
If <code class="docutils literal notranslate"><span class="pre">url</span></code> is not a string, returns back the value given.</p>
<p>Returns a URL in the format <code class="docutils literal notranslate"><span class="pre">https://&lt;url&gt;/#&lt;incident_id&gt;?orgId=&lt;org_id&gt;&amp;taskId=&lt;task_id&gt;&amp;tabName=details</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>url</strong> (<em>str</em>) – the URL of your SOAR instance</p></li>
<li><p><strong>incident_id</strong> (<em>str</em><em>|</em><em>int</em>) – the id of the incident</p></li>
<li><p><strong>task_id</strong> (<em>str</em><em>|</em><em>int</em>) – the id of the task</p></li>
<li><p><strong>org_id</strong> (<em>str</em><em>|</em><em>int</em>) – the id of the org the incident lives in</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>full URL to the task’s details tab</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="resilient_lib.components.resilient_common.clean_html">
<span class="sig-name descname"><span class="pre">clean_html</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">html_fragment</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#resilient_lib.components.resilient_common.clean_html" title="Link to this definition">¶</a></dt>
<dd><p>SOAR textarea fields return HTML fragments. This routine removes the
HTML and inserts any code within <code class="docutils literal notranslate"><span class="pre">&lt;div&gt;&lt;/div&gt;</span></code> with a linefeed.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The string returned from this method may not format well as no presentation of line feeds are preserved,
tags such as <code class="docutils literal notranslate"><span class="pre">&lt;br&gt;</span></code> or <code class="docutils literal notranslate"><span class="pre">&lt;ol&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">&lt;ul&gt;</span></code>, etc. are removed. See <a class="reference internal" href="#resilient_lib.components.html2markdown.MarkdownParser" title="resilient_lib.components.html2markdown.MarkdownParser"><code class="xref py py-class docutils literal notranslate"><span class="pre">MarkdownParser</span></code></a> class for a better way to translate
html input to markdown.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>html_fragment</strong> (<em>str</em>) – the html to clean up</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>cleaned up code</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="resilient_lib.components.resilient_common.close_incident">
<span class="sig-name descname"><span class="pre">close_incident</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">res_client</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">incident_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">handle_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#resilient_lib.components.resilient_common.close_incident" title="Link to this definition">¶</a></dt>
<dd><p>Close an incident in SOAR.</p>
<ul class="simple">
<li><p>Any <strong>required on close (roc)</strong> fields that
are needed, pass them as a <code class="docutils literal notranslate"><span class="pre">field_name:field_value</span></code> dict in <code class="docutils literal notranslate"><span class="pre">kwargs</span></code></p></li>
<li><p>If any <strong>roc</strong> select field needs to be identified as its name,
set <code class="docutils literal notranslate"><span class="pre">handle_names</span></code> to <code class="docutils literal notranslate"><span class="pre">True</span></code></p></li>
</ul>
<p><strong>Example:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">res</span> <span class="o">=</span> <span class="n">close_incident</span><span class="p">(</span>
    <span class="n">res_client</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">rest_client</span><span class="p">(),</span>
    <span class="n">incident_id</span><span class="o">=</span><span class="n">fn_inputs</span><span class="o">.</span><span class="n">incident_id</span><span class="p">,</span>
    <span class="n">kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;resolution_id&quot;</span><span class="p">:</span> <span class="s2">&quot;Duplicate&quot;</span><span class="p">,</span> <span class="s2">&quot;resolution_summary&quot;</span><span class="p">:</span> <span class="s2">&quot;This ticket is a duplicate&quot;</span><span class="p">},</span>
    <span class="n">handle_names</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>res_client</strong> (<em>resilient_circuits.ResilientComponent.rest_client</em><em>(</em><em>)</em>) – required for communication back to SOAR</p></li>
<li><p><strong>incident_id</strong> (<em>int</em><em>|</em><em>str</em>) – id of the incident</p></li>
<li><p><strong>kwargs</strong> (<em>dict</em>) – required fields needed to close an incident in a <code class="docutils literal notranslate"><span class="pre">field_name:field_value</span></code> format</p></li>
<li><p><strong>handle_names</strong> (<em>bool</em>) – if <code class="docutils literal notranslate"><span class="pre">True</span></code>, any select field types in <code class="docutils literal notranslate"><span class="pre">kwargs</span></code> will take <code class="docutils literal notranslate"><span class="pre">str</span></code> instead of <code class="docutils literal notranslate"><span class="pre">int</span></code> as their value</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Response from the server indicating if the incident was closed or not</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>requests.Response</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="resilient_lib.components.resilient_common.get_file_attachment">
<span class="sig-name descname"><span class="pre">get_file_attachment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">res_client</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">incident_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">artifact_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attachment_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#resilient_lib.components.resilient_common.get_file_attachment" title="Link to this definition">¶</a></dt>
<dd><p>Call the SOAR REST API to get the attachment or artifact data for
an Incident or a Task</p>
<ul class="simple">
<li><p>If <code class="docutils literal notranslate"><span class="pre">incident_id</span></code> and <code class="docutils literal notranslate"><span class="pre">artifact_id</span></code> are defined it will get that Artifact</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">incident_id</span></code> and <code class="docutils literal notranslate"><span class="pre">attachment_id</span></code> are defined it will get that Incident Attachment</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">incident_id</span></code>, <code class="docutils literal notranslate"><span class="pre">task_id</span></code> and <code class="docutils literal notranslate"><span class="pre">attachment_id</span></code> are defined it will get that Task Attachment</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">artifact_id</span></code> must reference an Artifact that is a downloadable type or it will
raise a <code class="docutils literal notranslate"><span class="pre">resilient.SimpleHTTPException</span></code></p>
</div>
<p><strong>Example:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">artifact_data</span> <span class="o">=</span> <span class="n">get_file_attachment</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rest_client</span><span class="p">(),</span> <span class="n">incident_id</span><span class="o">=</span><span class="mi">2001</span><span class="p">,</span> <span class="n">artifact_id</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;malware.eml&quot;</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">artifact_data</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>res_client</strong> (<em>resilient_circuits.ResilientComponent.rest_client</em><em>(</em><em>)</em>) – required for communication back to SOAR</p></li>
<li><p><strong>incident_id</strong> (<em>int</em><em>|</em><em>str</em>) – id of the Incident</p></li>
<li><p><strong>artifact_id</strong> (<em>int</em><em>|</em><em>str</em>) – id of the Incident’s Artifact to download</p></li>
<li><p><strong>task_id</strong> (<em>int</em><em>|</em><em>str</em>) – id of the Task to download it’s Attachment from</p></li>
<li><p><strong>attachment_id</strong> (<em>int</em><em>|</em><em>str</em>) – id of the Incident’s Attachment to download</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>byte string of attachment</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="resilient_lib.components.resilient_common.get_file_attachment_metadata">
<span class="sig-name descname"><span class="pre">get_file_attachment_metadata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">res_client</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">incident_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">artifact_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attachment_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#resilient_lib.components.resilient_common.get_file_attachment_metadata" title="Link to this definition">¶</a></dt>
<dd><p>Call the SOAR REST API to get the attachment or artifact attachment metadata</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>res_client</strong> (<em>resilient_circuits.ResilientComponent.rest_client</em><em>(</em><em>)</em>) – required for communication back to SOAR</p></li>
<li><p><strong>incident_id</strong> (<em>int</em><em>|</em><em>str</em>) – id of the Incident</p></li>
<li><p><strong>artifact_id</strong> (<em>int</em><em>|</em><em>str</em>) – id of the Incident’s Artifact</p></li>
<li><p><strong>task_id</strong> (<em>int</em><em>|</em><em>str</em>) – id of the Task to get it’s Attachment metadata</p></li>
<li><p><strong>attachment_id</strong> (<em>int</em><em>|</em><em>str</em>) – id of the Incident’s Attachment</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>File metadata returned from endpoint</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="resilient_lib.components.resilient_common.get_file_attachment_name">
<span class="sig-name descname"><span class="pre">get_file_attachment_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">res_client</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">incident_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">artifact_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attachment_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#resilient_lib.components.resilient_common.get_file_attachment_name" title="Link to this definition">¶</a></dt>
<dd><p>Call the SOAR REST API to get the attachment or artifact attachment name</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>res_client</strong> (<em>resilient_circuits.ResilientComponent.rest_client</em><em>(</em><em>)</em>) – required for communication back to SOAR</p></li>
<li><p><strong>incident_id</strong> (<em>int</em><em>|</em><em>str</em>) – id of the Incident</p></li>
<li><p><strong>task_id</strong> (<em>int</em><em>|</em><em>str</em>) – id of the Task</p></li>
<li><p><strong>attachment_id</strong> (<em>int</em><em>|</em><em>str</em>) – id of the Incident’s Attachment to get the name for</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>name of the Attachment or Artifact</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="resilient_lib.components.resilient_common.readable_datetime">
<span class="sig-name descname"><span class="pre">readable_datetime</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">timestamp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">milliseconds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rtn_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'%Y-%m-%dT%H:%M:%SZ'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#resilient_lib.components.resilient_common.readable_datetime" title="Link to this definition">¶</a></dt>
<dd><p>Convert an epoch timestamp to a string using a format</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>timestamp</strong> (<em>int</em>) – ts of object sent from SOAR Server i.e. <code class="docutils literal notranslate"><span class="pre">incident.create_date</span></code></p></li>
<li><p><strong>milliseconds</strong> (<em>bool</em>) – Set to <code class="docutils literal notranslate"><span class="pre">True</span></code> if ts in milliseconds</p></li>
<li><p><strong>rtn_format</strong> (<em>str</em>) – Format of resultant string. See <a class="reference external" href="https://docs.python.org/3.6/library/datetime.html#strftime-and-strptime-behavior">https://docs.python.org/3.6/library/datetime.html#strftime-and-strptime-behavior</a> for options</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>string representation of timestamp</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="resilient_lib.components.resilient_common.str_to_bool">
<span class="sig-name descname"><span class="pre">str_to_bool</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#resilient_lib.components.resilient_common.str_to_bool" title="Link to this definition">¶</a></dt>
<dd><p>Convert value to either a <code class="docutils literal notranslate"><span class="pre">True</span></code> or <code class="docutils literal notranslate"><span class="pre">False</span></code> boolean</p>
<p>Returns <code class="docutils literal notranslate"><span class="pre">False</span></code> if <code class="docutils literal notranslate"><span class="pre">value</span></code> is anything
other than: <code class="docutils literal notranslate"><span class="pre">'1',</span> <span class="pre">'true',</span> <span class="pre">'yes'</span> <span class="pre">or</span> <span class="pre">'on'</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>value</strong> (<em>str</em>) – the value to convert</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">True</span></code> or <code class="docutils literal notranslate"><span class="pre">False</span></code></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="resilient_lib.components.resilient_common.unescape">
<span class="sig-name descname"><span class="pre">unescape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#resilient_lib.components.resilient_common.unescape" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Return unescaped data such as:</dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&amp;gt;</span></code> converts to <code class="docutils literal notranslate"><span class="pre">&gt;</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&amp;quot</span></code> converts to <code class="docutils literal notranslate"><span class="pre">'</span></code></p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>str</em>) – text to convert</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the text unescaped</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="resilient_lib.components.resilient_common.validate_fields">
<span class="sig-name descname"><span class="pre">validate_fields</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#resilient_lib.components.resilient_common.validate_fields" title="Link to this definition">¶</a></dt>
<dd><p>Ensure each mandatory field in <code class="docutils literal notranslate"><span class="pre">field_list</span></code> is present in <code class="docutils literal notranslate"><span class="pre">kwargs</span></code>.
Throw ValueError if not.</p>
<p><code class="docutils literal notranslate"><span class="pre">field_list</span></code> can be a list/tuple of <code class="docutils literal notranslate"><span class="pre">strings</span></code> where each string is
a field name or it can be a list/tuple of <code class="docutils literal notranslate"><span class="pre">dicts</span></code> where each item
has the attributes <code class="docutils literal notranslate"><span class="pre">name</span></code> (<strong>required</strong>) and <code class="docutils literal notranslate"><span class="pre">placeholder</span></code> (<strong>optional</strong>).</p>
<p><code class="docutils literal notranslate"><span class="pre">kwargs</span></code> can be a dict or namedtuple. If a namedtuple, it calls its
<code class="docutils literal notranslate"><span class="pre">kwargs._as_dict()</span></code> method and raises a <code class="docutils literal notranslate"><span class="pre">ValueError</span></code> if it does not succeed.</p>
<ul class="simple">
<li><p>If the value of the item in <code class="docutils literal notranslate"><span class="pre">kwargs</span></code> is equal to its <code class="docutils literal notranslate"><span class="pre">placeholder</span></code>
defined in <code class="docutils literal notranslate"><span class="pre">field_list</span></code>, a <code class="docutils literal notranslate"><span class="pre">ValueError</span></code> is raised.</p></li>
<li><p>If an item in <code class="docutils literal notranslate"><span class="pre">kwargs</span></code> is a <em>Resilient Select Function Input</em>, its
value will be a <code class="docutils literal notranslate"><span class="pre">dict</span></code> that has a <code class="docutils literal notranslate"><span class="pre">name</span></code> attribute. This returns
the value of <code class="docutils literal notranslate"><span class="pre">name</span></code>.</p></li>
<li><p>If an item in <code class="docutils literal notranslate"><span class="pre">kwargs</span></code> is a <em>Resilient Multi-Select Function Input</em>, its
value will be a list of <code class="docutils literal notranslate"><span class="pre">dicts</span></code> that have the <code class="docutils literal notranslate"><span class="pre">name</span></code> attribute. This
returns a list of the <code class="docutils literal notranslate"><span class="pre">name</span></code> values for that item.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>field_list</strong> (<em>list</em><em>|</em><em>tuple</em>) – the mandatory fields. <em>Can be an empty list if no mandatory fields.</em></p></li>
<li><p><strong>kwargs</strong> (<em>dict</em><em>|</em><em>namedtuple</em>) – dict or a namedtuple of all the fields to search.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – if a field is missing</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>a Dictionary of all fields with Select/Multi-Select fields handled.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="resilient_lib.components.resilient_common.write_file_attachment">
<span class="sig-name descname"><span class="pre">write_file_attachment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">res_client</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">datastream</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">incident_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">content_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#resilient_lib.components.resilient_common.write_file_attachment" title="Link to this definition">¶</a></dt>
<dd><p>Add a file attachment to SOAR using the REST API
to an Incident or a Task</p>
<p><strong>Example:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;malware.eml&quot;</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">data_stream</span><span class="p">:</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">write_file_attachment</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rest_client</span><span class="p">(),</span> <span class="s2">&quot;malware.eml&quot;</span><span class="p">,</span> <span class="n">data_stream</span><span class="p">,</span> <span class="mi">2001</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>res_client</strong> (<a class="reference internal" href="../resilient-circuits/resilient-circuits.html#resilient_circuits.actions_component.ResilientComponent.rest_client" title="resilient_circuits.actions_component.ResilientComponent.rest_client"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResilientComponent.rest_client()</span></code></a>) – required for communication back to SOAR</p></li>
<li><p><strong>file_name</strong> (<em>str</em>) – name of the attachment to create</p></li>
<li><p><strong>dataStream</strong> (<em>stream</em><em> of </em><em>bytes</em>) – stream of bytes used to create the attachment</p></li>
<li><p><strong>incident_id</strong> (<em>int</em><em>|</em><em>str</em>) – id of the Incident</p></li>
<li><p><strong>task_id</strong> (<em>int</em><em>|</em><em>str</em>) – (optional) id of the Task</p></li>
<li><p><strong>content_type</strong> – (optional) MIME type of attachment. Default is <code class="docutils literal notranslate"><span class="pre">&quot;application/octet-stream&quot;</span></code></p></li>
<li><p><strong>content_type</strong> – str</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>metadata of new attachment created</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="resilient_lib.components.resilient_common.write_to_tmp_file">
<span class="sig-name descname"><span class="pre">write_to_tmp_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmp_file_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path_tmp_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#resilient_lib.components.resilient_common.write_to_tmp_file" title="Link to this definition">¶</a></dt>
<dd><p>Writes data to a file in a safely created temp directory.</p>
<ul class="simple">
<li><p>If no <code class="docutils literal notranslate"><span class="pre">tmp_file_name</span></code> is provided, a temp name will be given</p></li>
<li><p>If no <code class="docutils literal notranslate"><span class="pre">path_tmp_dir</span></code> is provided a temp directory is created with the prefix <strong>resilient-lib-tmp-</strong></p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When used, ensure you safely remove the created temp directory
in the <code class="docutils literal notranslate"><span class="pre">finally</span></code> block of the <code class="docutils literal notranslate"><span class="pre">FunctionComponent</span></code> code.</p>
</div>
<p><strong>Example:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">shutil</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">path_tmp_file</span><span class="p">,</span> <span class="n">path_tmp_dir</span> <span class="o">=</span> <span class="n">write_to_tmp_file</span><span class="p">(</span><span class="n">attachment_contents</span><span class="p">,</span> <span class="n">tmp_file_name</span><span class="o">=</span><span class="n">attachment_metadata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">))</span>

<span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
    <span class="k">yield</span> <span class="n">FunctionError</span><span class="p">()</span>

<span class="k">finally</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">path_tmp_dir</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">path_tmp_dir</span><span class="p">):</span>
        <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">path_tmp_dir</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>bytes</em>) – bytes to be written to the file</p></li>
<li><p><strong>tmp_file_name</strong> (<em>str</em>) – name to be given to the file</p></li>
<li><p><strong>path_tmp_dir</strong> (<em>str</em>) – path to an existing directory to use as the temp dir</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a tuple (path_tmp_file, path_tmp_dir)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="resilient_lib.components.html2markdown.MarkdownParser">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">MarkdownParser</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'**'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">italic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'*'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">underline</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'__'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strikeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'~~'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bullets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'*'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">number</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monospace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['{{',</span> <span class="pre">'}}']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">headers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['h1.',</span> <span class="pre">'h2.',</span> <span class="pre">'h3.',</span> <span class="pre">'h4.',</span> <span class="pre">'h5.',</span> <span class="pre">'h6.']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blockquote</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'```'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#resilient_lib.components.html2markdown.MarkdownParser" title="Link to this definition">¶</a></dt>
<dd><p>Convert HTML text into Markdown. A wrapper for
<a class="reference external" href="https://docs.python.org/3.6/library/html.parser.html#html.parser.HTMLParser">html.parser.HTMLParser</a></p>
<p><strong>Example:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">resilient_lib</span> <span class="kn">import</span> <span class="n">MarkdownParser</span>

<span class="n">data</span> <span class="o">=</span> <span class="s2">&quot;&lt;div class=&#39;rte&#39;&gt;&lt;div&gt;&lt;strong&gt;&lt;u&gt;underline and strong&lt;/u&gt;&lt;/strong&gt;&lt;/div&gt;&lt;/div&gt;&quot;</span>
<span class="n">markdown</span> <span class="o">=</span> <span class="s2">&quot;*_underline and strong_*&quot;</span>

<span class="n">parser</span> <span class="o">=</span> <span class="n">MarkdownParser</span><span class="p">(</span><span class="n">bold</span><span class="o">=</span><span class="s2">&quot;*&quot;</span><span class="p">,</span> <span class="n">underline</span><span class="o">=</span><span class="s2">&quot;_&quot;</span><span class="p">)</span> <span class="c1"># override defaults</span>
<span class="n">converted</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">converted</span><span class="p">,</span> <span class="n">markdown</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="resilient_lib.components.html2markdown.MarkdownParser.convert">
<span class="sig-prename descclassname"><span class="pre">MarkdownParser.</span></span><span class="sig-name descname"><span class="pre">convert</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#resilient_lib.components.html2markdown.MarkdownParser.convert" title="Link to this definition">¶</a></dt>
<dd><p>Converts html <code class="docutils literal notranslate"><span class="pre">data</span></code> to markdown and
returns the converted string</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>str</em>) – html text to convert</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>converted text to markdown</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py class" id="module-resilient_lib.components.oauth2_client_credentials_session">
<dt class="sig sig-object py" id="resilient_lib.components.oauth2_client_credentials_session.OAuth2ClientCredentialsSession">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">OAuth2ClientCredentialsSession</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">url</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">client_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">client_secret</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scope</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proxies</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#resilient_lib.components.oauth2_client_credentials_session.OAuth2ClientCredentialsSession" title="Link to this definition">¶</a></dt>
<dd><p>Wrapper around <a class="reference external" href="https://docs.python-requests.org/en/latest/api/#requests.Session">requests.Session</a>
which receives authentication tokens through the <code class="docutils literal notranslate"><span class="pre">client_credentials</span></code> type of OAuth2 grant,
and adds tokens to the requests made through the session.
It also attempts to keep track of the token and refresh it as needed.</p>
<ul class="simple">
<li><p>If proxies are defined, every request will use them.</p></li>
</ul>
<p>This session does not request authorization from the user first. The scope should be pre-authorized.</p>
<p><strong>Example:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">resilient_lib</span> <span class="kn">import</span> <span class="n">OAuth2ClientCredentialsSession</span><span class="p">,</span> <span class="n">RequestsCommon</span>

<span class="n">api1</span> <span class="o">=</span> <span class="n">OAuth2ClientCredentialsSession</span><span class="p">(</span><span class="s1">&#39;https://example1.com/&lt;tenant_id&gt;/oauth/v2/&#39;</span><span class="p">,</span> <span class="n">client_id</span><span class="o">=</span><span class="s1">&#39;xxx&#39;</span><span class="p">,</span> <span class="n">client_secret</span><span class="o">=</span><span class="s1">&#39;xxx&#39;</span><span class="p">)</span>
<span class="n">api2</span> <span class="o">=</span> <span class="n">OAuth2ClientCredentialsSession</span><span class="p">(</span><span class="s1">&#39;https://example2.com/&lt;tenant_id&gt;/oauth/v2/&#39;</span><span class="p">,</span> <span class="n">client_id</span><span class="o">=</span><span class="s1">&#39;xxx&#39;</span><span class="p">,</span> <span class="n">client_secret</span><span class="o">=</span><span class="s1">&#39;xxx&#39;</span><span class="p">)</span>

<span class="n">api1</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="s1">&#39;https://example1.com/v4/me/messages&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">{})</span> <span class="c1"># use as a regular requests session object</span>

<span class="n">api2</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;https://example2.com/v2/me/updates&#39;</span><span class="p">)</span>

<span class="c1"># When writing an integration, use RequestsCommon to get the proxies defined in in your app.config file.</span>
<span class="n">rc</span> <span class="o">=</span> <span class="n">RequestsCommon</span><span class="p">(</span><span class="n">opts</span><span class="p">,</span> <span class="n">function_opts</span><span class="p">)</span>
<span class="n">api3</span> <span class="o">=</span> <span class="n">OAuth2ClientCredentialsSession</span><span class="p">(</span><span class="s1">&#39;https://example3.com/</span><span class="si">{}</span><span class="s1">/test&#39;</span><span class="p">,</span> <span class="n">proxies</span><span class="o">=</span><span class="n">rc</span><span class="o">.</span><span class="n">get_proxies</span><span class="p">())</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>url</strong> (<em>str</em>) – Authorization URL, with tenant_id in it, if required</p></li>
<li><p><strong>client_id</strong> (<em>str</em>) – API key/User ID</p></li>
<li><p><strong>client_secret</strong> (<em>str</em>) – secret for API key</p></li>
<li><p><strong>scope</strong> (<em>[</em><em>str</em><em>]</em>) – (optional) list of scopes</p></li>
<li><p><strong>proxies</strong> (<em>dict</em>) – <p>(optional) Dictionary mapping protocol to the URL of the proxy.
The mapping protocol must be in the format:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;https_proxy&quot;</span><span class="p">:</span> <span class="s2">&quot;https://localhost:8080,</span>
    <span class="s2">&quot;http_proxy&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost:8080</span>
<span class="p">}</span>
</pre></div>
</div>
</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="resilient_lib.components.oauth2_client_credentials_session.OAuth2ClientCredentialsSession.add_authorization_header">
<span class="sig-name descname"><span class="pre">add_authorization_header</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">headers</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#resilient_lib.components.oauth2_client_credentials_session.OAuth2ClientCredentialsSession.add_authorization_header" title="Link to this definition">¶</a></dt>
<dd><p>Create headers needed for authentication/authorization, overriding the default ones if needed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>headers</strong> (<em>dict</em>) – Dictionary containing the <code class="docutils literal notranslate"><span class="pre">Authorization</span></code> header</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="resilient_lib.components.oauth2_client_credentials_session.OAuth2ClientCredentialsSession.authenticate">
<span class="sig-name descname"><span class="pre">authenticate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">url</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">client_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">client_secret</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scope</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proxies</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#resilient_lib.components.oauth2_client_credentials_session.OAuth2ClientCredentialsSession.authenticate" title="Link to this definition">¶</a></dt>
<dd><p>Authenticate with the endpoint</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="resilient_lib.components.oauth2_client_credentials_session.OAuth2ClientCredentialsSession.get_token">
<span class="sig-name descname"><span class="pre">get_token</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">token_url</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">client_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">client_secret</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scope</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proxies</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#resilient_lib.components.oauth2_client_credentials_session.OAuth2ClientCredentialsSession.get_token" title="Link to this definition">¶</a></dt>
<dd><p><strong>Override this method if the request needs specific information in the
body of the request</strong></p>
<p>For example, <em>Cloud Foundry</em> asking <code class="docutils literal notranslate"><span class="pre">grant_type</span></code> to be <code class="docutils literal notranslate"><span class="pre">password</span></code> and API key to be passed in <code class="docutils literal notranslate"><span class="pre">password</span></code>.</p>
<p>The default is:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">post_data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;client_id&#39;</span><span class="p">:</span> <span class="n">client_id</span><span class="p">,</span>
    <span class="s1">&#39;client_secret&#39;</span><span class="p">:</span> <span class="n">client_secret</span><span class="p">,</span>
    <span class="s1">&#39;grant_type&#39;</span><span class="p">:</span> <span class="s1">&#39;client_credentials&#39;</span>
<span class="p">}</span>

<span class="k">if</span> <span class="n">scope</span><span class="p">:</span>
    <span class="n">post_data</span><span class="p">[</span><span class="s1">&#39;scope&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">scope</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>token_url</strong> (<em>str</em>) – Authorization URL, with tenant_id in it, if required</p></li>
<li><p><strong>client_id</strong> (<em>str</em>) – API key/User ID</p></li>
<li><p><strong>client_secret</strong> (<em>str</em>) – secret for API key</p></li>
<li><p><strong>scope</strong> (<em>[</em><em>str</em><em>]</em>) – (optional) list of scopes</p></li>
<li><p><strong>proxies</strong> (<em>dict</em>) – (optional) Dictionary mapping protocol to the URL of the proxy.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the <code class="docutils literal notranslate"><span class="pre">response</span></code> from the <code class="docutils literal notranslate"><span class="pre">token_url</span></code></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python-requests.org/en/latest/api/#requests.Response">requests.Response</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="resilient_lib.components.oauth2_client_credentials_session.OAuth2ClientCredentialsSession.request">
<span class="sig-name descname"><span class="pre">request</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">method</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">url</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#resilient_lib.components.oauth2_client_credentials_session.OAuth2ClientCredentialsSession.request" title="Link to this definition">¶</a></dt>
<dd><p>Constructs a <a class="reference external" href="https://docs.python-requests.org/en/latest/api/#requests.Request">requests.Request</a>,
injects it with tokens and sends it in a new session to avoid having one session constantly open.</p>
<p>This uses the <code class="docutils literal notranslate"><span class="pre">requests.request()</span></code> function to
make a call. The inputs are mapped to this function.
See <a class="reference external" href="https://docs.python-requests.org/en/latest/api/#requests.request">requests.request()</a>
for information on any parameters available</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>the <code class="docutils literal notranslate"><span class="pre">response</span></code> object</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><p><a class="reference external" href="https://docs.python-requests.org/en/latest/api/#requests.Response">requests.Response</a></p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="resilient_lib.components.oauth2_client_credentials_session.OAuth2ClientCredentialsSession.update_token">
<span class="sig-name descname"><span class="pre">update_token</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#resilient_lib.components.oauth2_client_credentials_session.OAuth2ClientCredentialsSession.update_token" title="Link to this definition">¶</a></dt>
<dd><p>Institutes a request for a new access token.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong> – If it cannot update the token</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if could get a new token</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="common-request-methods">
<h2>Common Request Methods<a class="headerlink" href="#common-request-methods" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="resilient_lib.components.requests_common.RequestsCommon">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">RequestsCommon</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">opts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">function_opts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#resilient_lib.components.requests_common.RequestsCommon" title="Link to this definition">¶</a></dt>
<dd><p>This class represents common functions around the use of the requests package for REST based APIs.
It incorporates the app.config section <code class="docutils literal notranslate"><span class="pre">[integrations]</span></code> which can be used to define a common set of proxies
for use by all functions using this library.</p>
<p>Any similar properties in the function’s section would override the [integrations] properties.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In the Atomic Function template, as of version 41.1, <a class="reference internal" href="#resilient_lib.components.requests_common.RequestsCommon" title="resilient_lib.components.requests_common.RequestsCommon"><code class="xref py py-class docutils literal notranslate"><span class="pre">RequestsCommon</span></code></a> is instantiated and available
in a class that inherits <a class="reference internal" href="../resilient-circuits/resilient-circuits.html#resilient_circuits.app_function_component.AppFunctionComponent" title="resilient_circuits.app_function_component.AppFunctionComponent"><code class="xref py py-class docutils literal notranslate"><span class="pre">AppFunctionComponent</span></code></a> as an <code class="docutils literal notranslate"><span class="pre">rc</span></code> attribute:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rc</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="n">url</span><span class="o">=</span><span class="s2">&quot;ibm.com&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>opts</strong> (<em>dict</em>) – all configurations found in the app.config file</p></li>
<li><p><strong>function_opts</strong> (<em>dict</em>) – all configurations found in the <code class="docutils literal notranslate"><span class="pre">[my_function]</span></code> section of the app.config file</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="resilient_lib.components.requests_common.RequestsCommon.execute">
<span class="sig-prename descclassname"><span class="pre">RequestsCommon.</span></span><span class="sig-name descname"><span class="pre">execute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">url</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proxies=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callback=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clientauth=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verify=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">retry_tries=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">retry_delay=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">retry_max_delay=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">retry_backoff=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">retry_jitter=0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">retry_exceptions=&lt;class</span> <span class="pre">'requests.exceptions.HTTPError'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#resilient_lib.components.requests_common.RequestsCommon.execute" title="Link to this definition">¶</a></dt>
<dd><p>Constructs and sends a request. Returns a
<a class="reference external" href="https://docs.python-requests.org/en/latest/api/#requests.Response">requests.Response</a> object.</p>
<p>This uses the <code class="docutils literal notranslate"><span class="pre">requests.request()</span></code> function to
make a call. The inputs are mapped to this function.
See <a class="reference external" href="https://docs.python-requests.org/en/latest/api/#requests.request">requests.request()</a>
for information on any parameters available, but not documented here.</p>
<p>Retries can be achieved through the parameters prefixed with <code class="docutils literal notranslate"><span class="pre">retry_&lt;param&gt;</span></code>. Retry is only available in PY3+.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>method</strong> (<em>str</em>) – Rest method to execute (<code class="docutils literal notranslate"><span class="pre">GET</span></code>, <code class="docutils literal notranslate"><span class="pre">POST</span></code>, etc…)</p></li>
<li><p><strong>url</strong> (<em>str</em>) – URL to execute request against</p></li>
<li><p><strong>timeout</strong> (<em>float</em><em> or </em><em>tuple</em>) – (Optional) Number of seconds to wait for the server to send data
before sending a float or a timeout tuple (connect timeout, read timeout).
<em>See requests docs for more</em>. If <code class="docutils literal notranslate"><span class="pre">None</span></code> it looks in the <code class="docutils literal notranslate"><span class="pre">[integrations]</span></code>
section of your app.config for the <code class="docutils literal notranslate"><span class="pre">timeout</span></code> setting.</p></li>
<li><p><strong>proxies</strong> (<em>dict</em>) – <p>(Optional) Dictionary mapping protocol to the URL of the proxy.
The mapping protocol must be in the format:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;https_proxy&quot;</span><span class="p">:</span> <span class="s2">&quot;https://localhost:8080,</span>
    <span class="s2">&quot;http_proxy&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost:8080</span>
<span class="p">}</span>
</pre></div>
</div>
</p></li>
<li><p><strong>callback</strong> (<em>function</em>) – <p>(Optional) Once a response is received from the endpoint,
return this callback function passing in the <code class="docutils literal notranslate"><span class="pre">response</span></code> as its
only parameter. Can be used to specifically handle errors.
If <code class="docutils literal notranslate"><span class="pre">callback</span></code> is given, any retry parameters will be ignored
unless the <code class="docutils literal notranslate"><span class="pre">callback</span></code> function raises an error in the parameter
<code class="docutils literal notranslate"><span class="pre">retry_exceptions</span></code> (see below) in which case the retry logic will kick in.</p>
<p><strong>Example:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">resilient_lib</span> <span class="kn">import</span> <span class="n">IntegrationError</span><span class="p">,</span> <span class="n">RequestsCommon</span>

<span class="k">def</span> <span class="nf">custom_callback</span><span class="p">(</span><span class="n">response</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; custom callback function to handle 400 error codes &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">&gt;=</span> <span class="mi">400</span> <span class="ow">and</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">&lt;</span> <span class="mi">500</span><span class="p">:</span>
        <span class="c1"># raise ValueError which will be retried</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;retry me&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># all other status codes should return normally</span>
        <span class="c1"># note this bypasses the normal rc.execute logic which</span>
        <span class="c1"># would raise an error other 500 errors</span>
        <span class="k">return</span> <span class="n">response</span>

<span class="n">rc</span> <span class="o">=</span> <span class="n">RequestsCommon</span><span class="p">()</span>
<span class="k">try</span><span class="p">:</span>
    <span class="c1"># will retry 3 times then will raise IntegrationError</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">rc</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="s2">&quot;https://postman-echo.com/status/404&quot;</span><span class="p">,</span>
                               <span class="n">callback</span><span class="o">=</span><span class="n">custom_callback</span><span class="p">,</span> <span class="n">retry_tries</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                               <span class="n">retry_exceptions</span><span class="o">=</span><span class="ne">ValueError</span><span class="p">)</span>
<span class="k">except</span> <span class="n">IntegrationError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
</pre></div>
</div>
</p></li>
<li><p><strong>clientauth</strong> (<em>str</em><em> or </em><em>tuple</em><em>(</em><em>str</em><em>, </em><em>str</em><em>)</em>) – <p>(Optional) Equivalent to the <code class="docutils literal notranslate"><span class="pre">cert</span></code> parameter of <code class="docutils literal notranslate"><span class="pre">requests</span></code>.
Client-side certificates can be configured automatically in
the app’s section of the app.config. These values will be read in automatically by
<code class="docutils literal notranslate"><span class="pre">RequestsCommon</span></code> when <code class="docutils literal notranslate"><span class="pre">execute</span></code> is called.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">resilient</span><span class="p">]</span>
<span class="o">...</span> <span class="c1"># configs for connection to SOAR</span>

<span class="p">[</span><span class="n">fn_my_app</span><span class="p">]</span>
<span class="o">...</span> <span class="c1"># some other configs</span>
<span class="n">client_auth_cert</span><span class="o">=&lt;</span><span class="n">path_to_client_auth_cert_file</span><span class="o">&gt;</span>
<span class="n">client_auth_key</span><span class="o">=&lt;</span><span class="n">path_to_client_auth_private_key_file</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>If not set in the app.config file, the filepath for the client side certificate and the
private key can be passed to this function either as the path to a single file or as a
tuple of both files’ paths.</p>
</p></li>
<li><p><strong>verify</strong> (<em>bool</em><em> or </em><em>str</em>) – <p>(Optional) Either a boolean, in which case it controls whether requests verifies
the server’s TLS certificate, or a string, in which case it must be a path
to a CA bundle to use. Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code> as passed in here. If <code class="docutils literal notranslate"><span class="pre">None</span></code>,
then the value is searched for in the app’s section of the app.config. If no value
is found, then the requests.request() default of <code class="docutils literal notranslate"><span class="pre">True</span></code> is used. In that case,
the CA bundle found at <code class="docutils literal notranslate"><span class="pre">requests.utils.DEFAULT_CA_BUNDLE_PATH</span></code> is the CA bundle used,
which is usually a bundle provided by Mozilla. Setting <code class="docutils literal notranslate"><span class="pre">verify=True</span></code> is the safest option
and should only be changed if you have a self-signed certificate or you want to bypass
SSL for testing purposes. A production level app should never disable SSL verification
completely.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">fn_my_app</span><span class="p">]</span>
<span class="o">...</span> <span class="c1"># some other configs</span>
<span class="n">verify</span><span class="o">=&lt;</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">CA</span><span class="o">/</span><span class="n">bundle</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">use</span><span class="o">&gt;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The value held in the app’s config will be overwritten if a value is passed in by the call to <code class="docutils literal notranslate"><span class="pre">execute</span></code>.</p>
</div>
</p></li>
<li><p><strong>retry_tries</strong> (<em>int</em>) – (PY3 only) The maximum number of attempts. Default: <code class="docutils literal notranslate"><span class="pre">1</span></code> (no retry). Use <code class="docutils literal notranslate"><span class="pre">-1</span></code> for unlimited retries.
Matches <code class="docutils literal notranslate"><span class="pre">tries</span></code> parameter of <a class="reference external" href="https://github.com/eSAMTrade/retry#retry_call">retry.api.retry_call</a>.</p></li>
<li><p><strong>retry_delay</strong> (<em>int</em>) – <p>(PY3 only) Initial delay between attempts. Default: <code class="docutils literal notranslate"><span class="pre">1</span></code>.
Matches <code class="docutils literal notranslate"><span class="pre">delay</span></code> parameter of <a class="reference external" href="https://github.com/eSAMTrade/retry#retry_call">retry.api.retry_call</a>.</p>
</p></li>
<li><p><strong>retry_max_delay</strong> (<em>int</em>) – <p>(PY3 only) The maximum value of delay. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code> (no limit).
Matches <code class="docutils literal notranslate"><span class="pre">max_delay</span></code> parameter of <a class="reference external" href="https://github.com/eSAMTrade/retry#retry_call">retry.api.retry_call</a>.</p>
</p></li>
<li><p><strong>retry_backoff</strong> (<em>int</em>) – <p>(PY3 only) Multiplier applied to delay between attempts. Default: <code class="docutils literal notranslate"><span class="pre">1</span></code> (no backoff).
Matches <code class="docutils literal notranslate"><span class="pre">backoff</span></code> parameter of <a class="reference external" href="https://github.com/eSAMTrade/retry#retry_call">retry.api.retry_call</a>.</p>
</p></li>
<li><p><strong>retry_jitter</strong> (<em>int</em><em> | </em><em>tuple</em><em>(</em><em>int</em><em>, </em><em>int</em><em>)</em>) – <p>(PY3 only) Extra seconds added to delay between attempts. Default: <code class="docutils literal notranslate"><span class="pre">0</span></code>.
Fixed if a number, random if a range tuple (min, max).
Matches <code class="docutils literal notranslate"><span class="pre">jitter</span></code> parameter of <a class="reference external" href="https://github.com/eSAMTrade/retry#retry_call">retry.api.retry_call</a>.</p>
</p></li>
<li><p><strong>retry_exceptions</strong> (<em>Exception</em><em> | </em><em>tuple</em><em>(</em><em>Exception</em><em>)</em>) – <p>(PY3 only) An exception or a tuple of exceptions to catch.
Default: <code class="docutils literal notranslate"><span class="pre">requests.exceptions.HTTPError</span></code>.
Matches <code class="docutils literal notranslate"><span class="pre">exceptions</span></code> parameter of <a class="reference external" href="https://github.com/eSAMTrade/retry#retry_call">retry.api.retry_call</a>.</p>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the <code class="docutils literal notranslate"><span class="pre">response</span></code> from the endpoint or return <code class="docutils literal notranslate"><span class="pre">callback</span></code> if defined.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><p><a class="reference external" href="https://docs.python-requests.org/en/latest/api/#requests.Response">requests.Response</a> object
or <code class="docutils literal notranslate"><span class="pre">callback</span></code> function.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="resilient_lib.components.requests_common.RequestsCommon.get_proxies">
<span class="sig-prename descclassname"><span class="pre">RequestsCommon.</span></span><span class="sig-name descname"><span class="pre">get_proxies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#resilient_lib.components.requests_common.RequestsCommon.get_proxies" title="Link to this definition">¶</a></dt>
<dd><p>Proxies can be specified globally for all integrations or specifically per function.</p>
<ul class="simple">
<li><p>If the environmental variables HTTPS_PROXY, HTTP_PROXY and NO_PROXY
are set, this returns <code class="docutils literal notranslate"><span class="pre">None</span></code>, as if for a <a class="reference external" href="https://docs.python-requests.org/en/latest/api/#requests.Request">requests.Request</a>.
If <code class="docutils literal notranslate"><span class="pre">proxies</span></code> are <code class="docutils literal notranslate"><span class="pre">None</span></code>, the environmental variables are used</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">http_proxy</span></code> or <code class="docutils literal notranslate"><span class="pre">https_proxy</span></code> is set in the <strong>Function Section</strong> (<code class="docutils literal notranslate"><span class="pre">[my_function]</span></code>) of your app.config file,
returns a dictionary mapping protocol to the URL of the proxy.</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">http_proxy</span></code> or <code class="docutils literal notranslate"><span class="pre">https_proxy</span></code> is set in the <strong>Integrations Section</strong> (<code class="docutils literal notranslate"><span class="pre">[integrations]</span></code>) of your app.config file,
returns a dictionary mapping protocol to the URL of the proxy.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A dictionary mapping protocol to the URL of the proxy or <code class="docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict or <code class="docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="resilient_lib.components.requests_common.RequestsCommon.get_verify">
<span class="sig-prename descclassname"><span class="pre">RequestsCommon.</span></span><span class="sig-name descname"><span class="pre">get_verify</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#resilient_lib.components.requests_common.RequestsCommon.get_verify" title="Link to this definition">¶</a></dt>
<dd><p>Get <code class="docutils literal notranslate"><span class="pre">verify</span></code> parameter from app config or from env var
<code class="docutils literal notranslate"><span class="pre">REQUESTS_CA_BUNDLE</span></code> which is the default way to set
verify with python requests library.</p>
<p>Value can be set in <code class="docutils literal notranslate"><span class="pre">[integrations]</span></code> or in the <code class="docutils literal notranslate"><span class="pre">[fn_my_app]</span></code> section</p>
<p>Value in <code class="docutils literal notranslate"><span class="pre">[fn_my_app]</span></code> takes precedence over <code class="docutils literal notranslate"><span class="pre">[integrations]</span></code>
which takes precedence over <code class="docutils literal notranslate"><span class="pre">REQUESTS_CA_BUNDLE</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>app_options</strong> (<em>dict</em>) – App config dict</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value to set <code class="docutils literal notranslate"><span class="pre">requests.session.verify</span></code> to.
Either a path or a boolean</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool or str or None (which will default to requests default which is <code class="docutils literal notranslate"><span class="pre">True</span></code>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="resilient_lib.components.requests_common.RequestsCommon.get_client_auth">
<span class="sig-prename descclassname"><span class="pre">RequestsCommon.</span></span><span class="sig-name descname"><span class="pre">get_client_auth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#resilient_lib.components.requests_common.RequestsCommon.get_client_auth" title="Link to this definition">¶</a></dt>
<dd><p>A client certificate for authenticating calls to external endpoints can be specified on a per function basis.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">client_auth_cert</span></code> and <code class="docutils literal notranslate"><span class="pre">client_auth_key</span></code> are set in the <strong>Function Section</strong> (<code class="docutils literal notranslate"><span class="pre">[my_function]</span></code>) of your app.config file,
returns a tuple containing the respective paths to the certificate and private key for the client cert.</p>
<p>Example:</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">my_function</span><span class="p">]</span>
<span class="o">...</span>
<span class="n">client_auth_cert</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">path_to_cert</span><span class="o">.</span><span class="n">pem</span><span class="o">&gt;</span>
<span class="n">client_auth_key</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">path_to_cert_private_key</span><span class="o">.</span><span class="n">pem</span><span class="o">&gt;</span>
</pre></div>
</div>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The filepaths for the client side certificate and the private key as a tuple of both files’ paths
or <code class="docutils literal notranslate"><span class="pre">None</span></code> if either one of the values are missing</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple(str, str)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="resilient_lib.components.requests_common.RequestsCommon.get_timeout">
<span class="sig-prename descclassname"><span class="pre">RequestsCommon.</span></span><span class="sig-name descname"><span class="pre">get_timeout</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#resilient_lib.components.requests_common.RequestsCommon.get_timeout" title="Link to this definition">¶</a></dt>
<dd><p>Get the default timeout value in the <strong>Function Section</strong> (<code class="docutils literal notranslate"><span class="pre">[my_function]</span></code>) of your app.config file,
or from the <strong>Integrations Section</strong> (<code class="docutils literal notranslate"><span class="pre">[integrations]</span></code>) of your app.config file.</p>
<p><code class="docutils literal notranslate"><span class="pre">[my_function]</span></code> section takes precedence over <code class="docutils literal notranslate"><span class="pre">[integrations]</span></code> section value.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>timeout value</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="resilient_lib.components.requests_common.RequestsCommonWithoutSession">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">RequestsCommonWithoutSession</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#resilient_lib.components.requests_common.RequestsCommonWithoutSession" title="Link to this definition">¶</a></dt>
<dd><p>This class extends <a class="reference internal" href="#resilient_lib.components.requests_common.RequestsCommon" title="resilient_lib.components.requests_common.RequestsCommon"><code class="xref py py-class docutils literal notranslate"><span class="pre">RequestsCommon</span></code></a> maintaining the behavior of
<code class="docutils literal notranslate"><span class="pre">RequestsCommon</span></code> that was present in versions &lt;= 47.1.x.</p>
<p>The difference is that every time <code class="xref py py-class docutils literal notranslate"><span class="pre">RequestsCommonWithoutSession.execute()</span></code>
is called, this class will use <code class="docutils literal notranslate"><span class="pre">requests.request</span></code> to execute the request, while
<a class="reference internal" href="#resilient_lib.components.requests_common.RequestsCommon.execute" title="resilient_lib.components.requests_common.RequestsCommon.execute"><code class="xref py py-class docutils literal notranslate"><span class="pre">RequestsCommon.execute()</span></code></a> uses <code class="docutils literal notranslate"><span class="pre">Session().request</span></code>.</p>
<p>This class is interchangeable with <a class="reference internal" href="#resilient_lib.components.requests_common.RequestsCommon" title="resilient_lib.components.requests_common.RequestsCommon"><code class="xref py py-class docutils literal notranslate"><span class="pre">RequestsCommon</span></code></a> and code that uses
<a class="reference internal" href="#resilient_lib.components.requests_common.RequestsCommon" title="resilient_lib.components.requests_common.RequestsCommon"><code class="xref py py-class docutils literal notranslate"><span class="pre">RequestsCommon</span></code></a> can be simiply refactored to use <a class="reference internal" href="#resilient_lib.components.requests_common.RequestsCommonWithoutSession" title="resilient_lib.components.requests_common.RequestsCommonWithoutSession"><code class="xref py py-class docutils literal notranslate"><span class="pre">RequestsCommonWithoutSession</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>args</strong> (<em>list</em>) – positional arguments matching <a class="reference internal" href="#resilient_lib.components.requests_common.RequestsCommon" title="resilient_lib.components.requests_common.RequestsCommon"><code class="xref py py-class docutils literal notranslate"><span class="pre">RequestsCommon</span></code></a></p></li>
<li><p><strong>kwargs</strong> (<em>dict</em>) – named keyword arguments matching <a class="reference internal" href="#resilient_lib.components.requests_common.RequestsCommon" title="resilient_lib.components.requests_common.RequestsCommon"><code class="xref py py-class docutils literal notranslate"><span class="pre">RequestsCommon</span></code></a></p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="common-poller-methods">
<span id="id12"></span><h2>Common Poller Methods<a class="headerlink" href="#common-poller-methods" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="resilient_lib.components.poller_common.poller">
<span class="sig-name descname"><span class="pre">poller</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">named_poller_interval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">named_last_poller_time</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#resilient_lib.components.poller_common.poller" title="Link to this definition">¶</a></dt>
<dd><p>Decorator to wrap a function as the logic for a poller.</p>
<p><strong>Example:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">from</span> <span class="nn">threading</span> <span class="kn">import</span> <span class="n">Thread</span>

<span class="kn">from</span> <span class="nn">resilient_circuits</span> <span class="kn">import</span> <span class="n">AppFunctionComponent</span><span class="p">,</span> <span class="n">is_this_a_selftest</span>
<span class="kn">from</span> <span class="nn">resilient_lib</span> <span class="kn">import</span> <span class="n">poller</span><span class="p">,</span> <span class="n">get_last_poller_date</span>

<span class="n">PACKAGE_NAME</span> <span class="o">=</span> <span class="s2">&quot;fn_my_app&quot;</span>

<span class="n">LOG</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">MyPoller</span><span class="p">(</span><span class="n">AppFunctionComponent</span><span class="p">):</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">opts</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">PollerComponent</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">opts</span><span class="p">,</span> <span class="n">PACKAGE_NAME</span><span class="p">)</span>

        <span class="n">polling_interval</span> <span class="o">=</span> <span class="mi">5</span> <span class="c1"># set to 5 seconds or could get from ``self.options``</span>
        <span class="n">last_poller_time</span> <span class="o">=</span> <span class="n">get_last_poller_date</span><span class="p">(</span><span class="mi">120</span><span class="p">)</span> <span class="c1"># look back 2 hours</span>

        <span class="k">if</span> <span class="n">is_this_a_selftest</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="n">LOG</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Running selftest -- disabling poller&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">poller_thread</span> <span class="o">=</span> <span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="p">)</span>
            <span class="n">poller_thread</span><span class="o">.</span><span class="n">daemon</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">poller_thread</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

    <span class="nd">@poller</span><span class="p">(</span><span class="s1">&#39;polling_interval&#39;</span><span class="p">,</span> <span class="s1">&#39;last_poller_time&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="c1"># poll endpoint</span>
        <span class="n">query_results</span> <span class="o">=</span> <span class="n">query_entities_since_last_poll</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;last_poller_time&#39;</span><span class="p">])</span>

        <span class="c1"># process any results to create, update, or close case in SOAR</span>
        <span class="k">if</span> <span class="n">query_results</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">process_entity_list</span><span class="p">(</span><span class="n">query_results</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>named_poller_interval</strong> (<em>str</em>) – name of instance variable containing the poller interval in seconds</p></li>
<li><p><strong>named_last_poller_time</strong> (<em>datetime</em>) – name of instance variable containing the lookback value in mseconds</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class" id="module-resilient_lib.components.poller_common">
<dt class="sig sig-object py" id="resilient_lib.components.poller_common.SOARCommon">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">SOARCommon</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rest_client</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#resilient_lib.components.poller_common.SOARCommon" title="Link to this definition">¶</a></dt>
<dd><p>Common methods for accessing IBM SOAR cases and their entities: comments, attachments, etc.
This class and its methods should be used in conjunction with wrapped
polling logic to communicated with the SOAR platform.</p>
<dl class="py method">
<dt class="sig sig-object py" id="resilient_lib.components.poller_common.SOARCommon.create_case_comment">
<span class="sig-name descname"><span class="pre">create_case_comment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">case_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">note</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entity_comment_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entity_comment_header</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#resilient_lib.components.poller_common.SOARCommon.create_case_comment" title="Link to this definition">¶</a></dt>
<dd><p>Add a comment to the specified SOAR case by ID.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>case_id</strong> (<em>str</em><em>|</em><em>int</em>) – SOAR case ID</p></li>
<li><p><strong>note</strong> (<em>str</em>) – Content to be added as a note to the case</p></li>
<li><p><strong>entity_comment_id</strong> (<em>str</em><em>|</em><em>int</em>) – (Optional) entity comment id if updating an existing comment</p></li>
<li><p><strong>entity_comment_header</strong> (<em>str</em>) – (Optional) header to place in bold at the top of the note</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Response from posting the comment to SOAR</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="resilient_lib.components.poller_common.SOARCommon.create_datatable_row">
<span class="sig-name descname"><span class="pre">create_datatable_row</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">case_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">datatable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rowdata</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#resilient_lib.components.poller_common.SOARCommon.create_datatable_row" title="Link to this definition">¶</a></dt>
<dd><p>Create a row in a SOAR datatable.
<code class="docutils literal notranslate"><span class="pre">rowdata</span></code> should be formatted as a dictionary of
column name and value pairs</p>
<p><strong>Example:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">resilient_lib</span> <span class="kn">import</span> <span class="n">SOARCommon</span>

<span class="n">soar_common</span> <span class="o">=</span> <span class="n">SOARCommon</span><span class="p">(</span><span class="n">res_client</span><span class="p">)</span>

<span class="n">case_id</span> <span class="o">=</span> <span class="n">get_case_id</span><span class="p">()</span>
<span class="n">rowdata</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;column_1_api_name&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;column_2_api_name&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}</span>

<span class="n">soar_common</span><span class="o">.</span><span class="n">create_datatable_row</span><span class="p">(</span><span class="n">case_id</span><span class="p">,</span> <span class="s2">&quot;my_dt&quot;</span><span class="p">,</span> <span class="n">rowdata</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>case_id</strong> (<em>str</em><em>|</em><em>int</em>) – case containing the datatable</p></li>
<li><p><strong>datatable</strong> (<em>str</em>) – API name of datatable</p></li>
<li><p><strong>rowdata</strong> (<em>dict</em>) – columns and values to add</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="resilient_lib.components.poller_common.SOARCommon.create_soar_case">
<span class="sig-name descname"><span class="pre">create_soar_case</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">case_payload</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#resilient_lib.components.poller_common.SOARCommon.create_soar_case" title="Link to this definition">¶</a></dt>
<dd><p>Create a new IBM SOAR case based on a payload formatted for the API call.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>case_payload</strong> (<em>dict</em>) – Fields to use for creating a SOAR case</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>API result with the created case</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="resilient_lib.components.poller_common.SOARCommon.filter_soar_comments">
<span class="sig-name descname"><span class="pre">filter_soar_comments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">case_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entity_comments</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">soar_header</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#resilient_lib.components.poller_common.SOARCommon.filter_soar_comments" title="Link to this definition">¶</a></dt>
<dd><p>Read all SOAR comments from a case and remove those comments which have
already been synced using <code class="docutils literal notranslate"><span class="pre">soar_header</span></code> as a filter</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>case_id</strong> (<em>str</em><em>|</em><em>int</em>) – ([str]): [IBM SOAR case id]</p></li>
<li><p><strong>entity_comments</strong> (<em>list</em><em>(</em><em>str</em><em>)</em>) – list comments which the endpoint’s entity contains.
This will be a mix of comments sync’d from SOAR and new comments</p></li>
<li><p><strong>soar_header</strong> (<em>str</em>) – title added to SOAR comments to be filtered</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>list of remaining comments</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="resilient_lib.components.poller_common.SOARCommon.get_case">
<span class="sig-name descname"><span class="pre">get_case</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">case_id</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#resilient_lib.components.poller_common.SOARCommon.get_case" title="Link to this definition">¶</a></dt>
<dd><p>Get a SOAR case based on the case id</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>case_id</strong> (<em>str</em><em>|</em><em>int</em>) – ID of the case to get the details of</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Details of the case for a given ID</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="resilient_lib.components.poller_common.SOARCommon.get_case_artifacts">
<span class="sig-name descname"><span class="pre">get_case_artifacts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">case_id</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#resilient_lib.components.poller_common.SOARCommon.get_case_artifacts" title="Link to this definition">¶</a></dt>
<dd><p>Get all case artifacts</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>case_id</strong> (<em>str</em><em>|</em><em>int</em>) – ID of the case to get the details of</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="resilient_lib.components.poller_common.SOARCommon.get_case_attachment">
<span class="sig-name descname"><span class="pre">get_case_attachment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">case_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">artifact_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attachment_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_base64</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#resilient_lib.components.poller_common.SOARCommon.get_case_attachment" title="Link to this definition">¶</a></dt>
<dd><p>Get contents of a file attachment or artifact.</p>
<ul class="simple">
<li><p>If <code class="docutils literal notranslate"><span class="pre">incident_id</span></code> and <code class="docutils literal notranslate"><span class="pre">artifact_id</span></code> are defined it will get that Artifact</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">incident_id</span></code> and <code class="docutils literal notranslate"><span class="pre">attachment_id</span></code> are defined it will get that Incident Attachment</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">incident_id</span></code>, <code class="docutils literal notranslate"><span class="pre">task_id</span></code> and <code class="docutils literal notranslate"><span class="pre">attachment_id</span></code> are defined it will get that Task Attachment</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>case_id</strong> (<em>str</em><em>|</em><em>int</em>) – ID of the case to get the details of</p></li>
<li><p><strong>artifact_id</strong> (<em>str</em><em>|</em><em>int</em>) – ID of the Incident’s Artifact to download</p></li>
<li><p><strong>task_id</strong> (<em>str</em><em>|</em><em>int</em>) – ID of the Task to download it’s Attachment from</p></li>
<li><p><strong>attachment_id</strong> (<em>int</em><em>|</em><em>str</em>) – id of the Incident’s Attachment to download</p></li>
<li><p><strong>return_base64</strong> (<em>bool</em>) – if False, return value of the content will be given as bytes, default True returns a base64 encoded string</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>name of the artifact or file and base64 encoded string or byte string of attachment</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple(str, bytes|base64(str))</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="resilient_lib.components.poller_common.SOARCommon.get_case_attachments">
<span class="sig-name descname"><span class="pre">get_case_attachments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">case_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_base64</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#resilient_lib.components.poller_common.SOARCommon.get_case_attachments" title="Link to this definition">¶</a></dt>
<dd><p>Get all case attachments</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>case_id</strong> (<em>str</em><em>|</em><em>int</em>) – ID of the case to get the details of</p></li>
<li><p><strong>return_base64</strong> (<em>bool</em>) – if False, return value of the content will be given as bytes</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>list of attachments associated with the given case</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list[tuple(str, bytes|base64(str))]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="resilient_lib.components.poller_common.SOARCommon.get_case_comments">
<span class="sig-name descname"><span class="pre">get_case_comments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">case_id</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#resilient_lib.components.poller_common.SOARCommon.get_case_comments" title="Link to this definition">¶</a></dt>
<dd><p>Get all case comments</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>case_id</strong> (<em>str</em><em>|</em><em>int</em>) – ID of the case to get the details of</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="resilient_lib.components.poller_common.SOARCommon.get_case_tasks">
<span class="sig-name descname"><span class="pre">get_case_tasks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">case_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">want_layouts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">want_notes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">handle_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'names'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#resilient_lib.components.poller_common.SOARCommon.get_case_tasks" title="Link to this definition">¶</a></dt>
<dd><p>Get all the tasks from a SOAR case</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>case_id</strong> (<em>str</em><em>|</em><em>int</em>) – IBM SOAR case id</p></li>
<li><p><strong>want_layouts</strong> (<em>bool</em>) – If the task layout should be returned. Default is False.</p></li>
<li><p><strong>want_notes</strong> (<em>bool</em>) – If the task notes should be returned. Default is False.</p></li>
<li><p><strong>handle_format</strong> (<em>str</em>) – The format to return can be names, ids, or objects. Default is names.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of all the tasks for the given SOAR case</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="resilient_lib.components.poller_common.SOARCommon.get_soar_case">
<span class="sig-name descname"><span class="pre">get_soar_case</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">search_fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">open_cases</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uri_filters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'return_level=normal'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#resilient_lib.components.poller_common.SOARCommon.get_soar_case" title="Link to this definition">¶</a></dt>
<dd><p>Find a SOAR case which contains custom field(s) associated with the associated endpoint.
Returns only one case. See <a class="reference internal" href="#resilient_lib.components.poller_common.SOARCommon.get_soar_cases" title="resilient_lib.components.poller_common.SOARCommon.get_soar_cases"><code class="xref py py-class docutils literal notranslate"><span class="pre">SOARCommon.get_soar_cases()</span></code></a> for examples.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">search_fields</span></code> only supports custom fields.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>search_fields</strong> (<em>dict</em>) – Dictionary containing key/value pairs to search for a case match.
Field values can be True/False for <code class="docutils literal notranslate"><span class="pre">has_a_value</span></code> or <code class="docutils literal notranslate"><span class="pre">does_not_have_a_value</span></code>,
otherwise a field will use <code class="docutils literal notranslate"><span class="pre">equals</span></code> for the value.</p></li>
<li><p><strong>uri_filters</strong> (<em>str</em>) – Filters for the end of the uri. Default is “return_level=normal”</p></li>
<li><p><strong>open_cases</strong> (<em>bool</em>) – True if only querying open cases.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple with the matching case, if any, and any associated error message if something went wrong.
Returns <code class="docutils literal notranslate"><span class="pre">None</span></code> if no associated case was found.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple(dict, str)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="resilient_lib.components.poller_common.SOARCommon.get_soar_cases">
<span class="sig-name descname"><span class="pre">get_soar_cases</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">search_fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">open_cases</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uri_filters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'return_level=normal'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#resilient_lib.components.poller_common.SOARCommon.get_soar_cases" title="Link to this definition">¶</a></dt>
<dd><p>Get all IBM SOAR cases that match the given search fields.
To find all cases that are synced from the endpoint platform,
provide the unique search field that matches the unique id of your
endpoint solution.</p>
<p><strong>Example:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">resilient_lib</span> <span class="kn">import</span> <span class="n">SOARCommon</span>

<span class="n">soar_common</span> <span class="o">=</span> <span class="n">SOARCommon</span><span class="p">(</span><span class="n">res_client</span><span class="p">)</span>
<span class="n">found_id</span> <span class="o">=</span> <span class="n">get_id_from_endpoint_query_result</span><span class="p">()</span>
<span class="n">cases</span> <span class="o">=</span> <span class="n">soar_common</span><span class="o">.</span><span class="n">get_soar_cases</span><span class="p">({</span> <span class="s2">&quot;endpoint_id&quot;</span><span class="p">:</span> <span class="n">found_id</span> <span class="p">},</span> <span class="n">open_cases</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">search_fields</span></code> only supports custom fields.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>search_fields</strong> (<em>dict</em>) – Dictionary containing key/value pairs to search for a case match.
Field values can be True/False for <code class="docutils literal notranslate"><span class="pre">has_a_value</span></code> or <code class="docutils literal notranslate"><span class="pre">does_not_have_a_value</span></code>,
otherwise a field will use <code class="docutils literal notranslate"><span class="pre">equals</span></code> for the value.</p></li>
<li><p><strong>uri_filters</strong> (<em>str</em>) – Filters for the end of the uri. Default is “return_level=normal”</p></li>
<li><p><strong>open_cases</strong> (<em>bool</em>) – True if only querying open cases.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple with a list of cases whose values match the <code class="docutils literal notranslate"><span class="pre">search_fields</span></code> and any associated error message.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple(dict, str)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="resilient_lib.components.poller_common.SOARCommon.lookup_artifact_type">
<span class="sig-name descname"><span class="pre">lookup_artifact_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">artifact_type</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#resilient_lib.components.poller_common.SOARCommon.lookup_artifact_type" title="Link to this definition">¶</a></dt>
<dd><p>Return an artifact type based on it’s ID on SOAR. If not found, return None</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>artifact_type</strong> (<em>str</em>) – artifact type to search for in SOAR</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>found artifact type if found in SOAR</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="resilient_lib.components.poller_common.SOARCommon.lookup_incident_types">
<span class="sig-name descname"><span class="pre">lookup_incident_types</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">incident_type_ids</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#resilient_lib.components.poller_common.SOARCommon.lookup_incident_types" title="Link to this definition">¶</a></dt>
<dd><p>Return an incident type based on it’s ID. If not found, return None</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>incident_type_ids</strong> (<em>list</em><em>(</em><em>str</em><em>)</em>) – list of incident type IDs to check for in SOAR</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>list of incident types that match in SOAR what was given</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list(str)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="resilient_lib.components.poller_common.SOARCommon.update_soar_case">
<span class="sig-name descname"><span class="pre">update_soar_case</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">case_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">case_payload</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#resilient_lib.components.poller_common.SOARCommon.update_soar_case" title="Link to this definition">¶</a></dt>
<dd><p>Update an IBM SOAR case (usually from a rendered Jinja template).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>case_payload</strong> (<em>dict</em>) – Fields to be updated and their values</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The updated SOAR case case</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="resilient_lib.components.poller_common.eval_mapping">
<span class="sig-name descname"><span class="pre">eval_mapping</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eval_value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wrapper</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#resilient_lib.components.poller_common.eval_mapping" title="Link to this definition">¶</a></dt>
<dd><p>Map a JSON string to a python object. Safely evaluates the values with the use
of <code class="docutils literal notranslate"><span class="pre">ast.literal_eval</span></code> and can ONLY convert to a list or a dictionary.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">wrapper</span></code> is optional (but recommended) to ensure that the <code class="docutils literal notranslate"><span class="pre">eval_value</span></code>
is properly formatted as JSON. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, then assumes
that the <code class="docutils literal notranslate"><span class="pre">eval_value</span></code> comes pre-formatted in acceptable JSON format</p>
</div>
<p>This method is intended to be used to safely take input strings from the user’s
config file that will eventually need to evaluated as JSON elsewhere in the code.</p>
<p><strong>Example:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">resilient_lib</span> <span class="kn">import</span> <span class="n">eval_mapping</span>

<span class="n">config_value</span> <span class="o">=</span> <span class="n">app_configs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;some_config&quot;</span><span class="p">)</span>
<span class="c1"># Assume that &#39;config_value&#39; has a value of</span>
<span class="c1"># &#39;&quot;source&quot;:&quot;A&quot;,&quot;tags&quot;:[&quot;tagA&quot;],&quot;priorities&quot;:[40,50]&#39;</span>

<span class="c1"># parse the values to a dict, using a dictionary wrapper:</span>
<span class="n">parsed_config</span> <span class="o">=</span> <span class="n">eval_mapping</span><span class="p">(</span><span class="n">config_value</span><span class="p">,</span> <span class="s2">&quot;{{ </span><span class="si">{}</span><span class="s2"> }}&quot;</span><span class="p">)</span>

<span class="c1"># the returned value is a dict like:</span>
<span class="c1"># {</span>
<span class="c1">#   &quot;source&quot;: &quot;A&quot;,</span>
<span class="c1">#   &quot;tags&quot;: [&quot;tagA&quot;],</span>
<span class="c1">#   &quot;priorities&quot;: [40, 50]</span>
<span class="c1"># }</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eval_value</strong> (<em>str</em>) – json fragment to evaluate</p></li>
<li><p><strong>wrapper</strong> (<em>str</em>) – wrapper to put the source value into <code class="docutils literal notranslate"><span class="pre">[{}]</span></code> or <code class="docutils literal notranslate"><span class="pre">{{</span> <span class="pre">{}</span> <span class="pre">}}</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>converted data</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list|dict</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-resilient_lib.components.templates_common">
<span id="common-jinja-methods"></span><h2>Common Jinja Methods<a class="headerlink" href="#module-resilient_lib.components.templates_common" title="Link to this heading">¶</a></h2>
<p>Common methods and filters used to process 
<a class="reference external" href="https://jinja.palletsprojects.com/en/3.1.x/">Jinja Templates</a></p>
<p><strong>Usage:</strong></p>
<ol class="arabic simple">
<li><p>Create a Jinja template in the <code class="docutils literal notranslate"><span class="pre">/util/templates</span></code> directory of the App.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Normally a template is in JSON format:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;{{ alert_name }}&quot;</span><span class="p">,</span>
    <span class="s2">&quot;severity&quot;</span><span class="p">:</span> <span class="s2">&quot;{{ alert_severity }}&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<p>2. (<em>Optional</em>) Add an option to your <code class="docutils literal notranslate"><span class="pre">app.config</span></code> file to specify an absolute
path to a custom Jinja template called: <code class="docutils literal notranslate"><span class="pre">custom_template_path</span></code> - if not provided the
value of <code class="docutils literal notranslate"><span class="pre">DEFAULT_TEMPLATE_PATH</span></code> is used.</p>
<ol class="arabic simple" start="3">
<li><p>Add the following code to your <strong>Function</strong>:</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pkg_resources</span>
<span class="kn">from</span> <span class="nn">resilient_circuits</span> <span class="kn">import</span> <span class="n">AppFunctionComponent</span><span class="p">,</span> <span class="n">FunctionResult</span><span class="p">,</span> <span class="n">app_function</span>
<span class="kn">from</span> <span class="nn">resilient_lib</span> <span class="kn">import</span> <span class="n">make_payload_from_template</span>

<span class="n">PACKAGE_NAME</span> <span class="o">=</span> <span class="s2">&quot;my_app&quot;</span>
<span class="n">FN_NAME</span> <span class="o">=</span> <span class="s2">&quot;my_function_using_jinja&quot;</span>

<span class="c1"># Creating an absolute path to the template</span>
<span class="n">DEFAULT_TEMPLATE_PATH</span> <span class="o">=</span> <span class="n">pkg_resources</span><span class="o">.</span><span class="n">resource_filename</span><span class="p">(</span><span class="n">PACKAGE_NAME</span><span class="p">,</span> <span class="s2">&quot;util/templates/&lt;default_name&gt;.jinja2&quot;</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">FunctionComponent</span><span class="p">(</span><span class="n">AppFunctionComponent</span><span class="p">):</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">opts</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">FunctionComponent</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">opts</span><span class="p">,</span> <span class="n">PACKAGE_NAME</span><span class="p">)</span>

    <span class="nd">@app_function</span><span class="p">(</span><span class="n">FN_NAME</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_app_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fn_inputs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Function: A function showing how to use Jinja templates</span>
<span class="sd">        Inputs:</span>
<span class="sd">            -   fn_inputs.alert_severity</span>
<span class="sd">            -   fn_inputs.device_id</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="n">custom_template_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">app_configs</span><span class="o">.</span><span class="n">custom_template_path</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">app_configs</span><span class="p">,</span> <span class="s2">&quot;custom_template_path&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>

        <span class="n">template_rendered</span> <span class="o">=</span> <span class="n">make_payload_from_template</span><span class="p">(</span>
            <span class="n">template_override</span><span class="o">=</span><span class="n">custom_template_path</span><span class="p">,</span>
            <span class="n">default_template</span><span class="o">=</span><span class="n">DEFAULT_TEMPLATE_PATH</span><span class="p">,</span>
            <span class="n">payload</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;alert_name&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Malware found on device </span><span class="si">{</span><span class="n">fn_inputs</span><span class="o">.</span><span class="n">device_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="s2">&quot;alert_severity&quot;</span><span class="p">:</span> <span class="n">fn_inputs</span><span class="o">.</span><span class="n">alert_severity</span>
            <span class="p">},</span>
            <span class="n">return_json</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">LOG</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">template_rendered</span><span class="p">)</span>

        <span class="n">results</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;template_rendered&quot;</span><span class="p">:</span> <span class="n">template_rendered</span><span class="p">}</span>

        <span class="k">yield</span> <span class="n">FunctionResult</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">INFO</span> <span class="p">[</span><span class="n">my_function_using_jinja</span><span class="p">]</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Malware found on device 303&#39;</span><span class="p">,</span> <span class="s1">&#39;severity&#39;</span><span class="p">:</span> <span class="s1">&#39;High&#39;</span><span class="p">}</span>
</pre></div>
</div>
<p>4. Update your <code class="docutils literal notranslate"><span class="pre">README.md</span></code> documentation file to include relevant information about the templates,
for example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>## Templates for SOAR Cases
It may necessary to modify the templates used to create SOAR cases based on a customer&#39;s required custom fields.
Below are the default templates used which can be copied, modified and used with app.config&#39;s
`custom_template_path` setting to override the default template.

### custom_template.jinja
```
{
    &quot;name&quot;: &quot;{{ alert_name }}&quot;,
    &quot;severity&quot;: &quot;{{ alert_severity }}&quot;
}
```
</pre></div>
</div>
<hr class="docutils" />
<dl class="py function">
<dt class="sig sig-object py" id="resilient_lib.components.templates_common.base64_filter">
<span class="sig-name descname"><span class="pre">base64_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">val</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#resilient_lib.components.templates_common.base64_filter" title="Link to this definition">¶</a></dt>
<dd><p><strong>base64</strong></p>
<p>Breaks text into fixed-width blocks. You can specify the
<code class="docutils literal notranslate"><span class="pre">indent</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>val</strong> (<em>str</em>) – The string to convert</p></li>
<li><p><strong>indent</strong> (<em>int</em>) – Number of tabs</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Converted string</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="resilient_lib.components.templates_common.camel_filter">
<span class="sig-name descname"><span class="pre">camel_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">val</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#resilient_lib.components.templates_common.camel_filter" title="Link to this definition">¶</a></dt>
<dd><p><strong>camel</strong></p>
<p>Convert text to CamelCase.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>val</strong> (<em>str</em>) – The string to convert</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Converted string</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">This</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">in</span> <span class="n">camel</span> <span class="n">case</span><span class="p">:</span> <span class="p">{{</span> <span class="n">a</span><span class="c1">#bc_def | camel }}</span>
<span class="o">&gt;&gt;&gt;</span> <span class="s1">&#39;ABcDef&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="resilient_lib.components.templates_common.global_jinja_env">
<span class="sig-name descname"><span class="pre">global_jinja_env</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#resilient_lib.components.templates_common.global_jinja_env" title="Link to this definition">¶</a></dt>
<dd><p>Return the Jinja environment with our resilient-lib custom filters.
This environment can be expanded upon to add additional custom filters.</p>
<p>See <a class="reference external" href="https://jinja.palletsprojects.com/en/3.1.x/api/#custom-filters">Jinja Custom Filters</a> for more.</p>
<p>Current custom filters available:</p>
<pre class="literal-block">json, js, html, url, idna, punycode, ldap, ps, sh, pretty, timestamp, iso8601, uniq, sample, camel, base64, soar_datetimeformat, soar_display_datetimeformat, soar_substitute, soar_splitpart, soar_trimlist</pre>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The Jinja environment</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://jinja.palletsprojects.com/en/3.1.x/api/#jinja2.Environment">jinja2.Environment</a></p>
</dd>
</dl>
<p><strong>Example:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">resilient</span><span class="o">-</span><span class="n">lib</span> <span class="kn">import</span> <span class="nn">global_jinja_env</span>

<span class="n">addl_custom_filters</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;filter_name&quot;</span><span class="p">:</span> <span class="n">method_name</span>
<span class="p">}</span>
<span class="n">env</span> <span class="o">=</span> <span class="n">global_jinja_env</span><span class="p">()</span>
<span class="n">env</span><span class="o">.</span><span class="n">globals</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">addl_custom_filters</span><span class="p">)</span>
<span class="n">env</span><span class="o">.</span><span class="n">filters</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">addl_custom_filters</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="resilient_lib.components.templates_common.html_filter">
<span class="sig-name descname"><span class="pre">html_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">val</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#resilient_lib.components.templates_common.html_filter" title="Link to this definition">¶</a></dt>
<dd><p><strong>html</strong></p>
<p>Produces HTML-encoded string of the value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>val</strong> (<em>str</em>) – The string to encode</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Encoded string</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="resilient_lib.components.templates_common.idna_filter">
<span class="sig-name descname"><span class="pre">idna_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">val</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#resilient_lib.components.templates_common.idna_filter" title="Link to this definition">¶</a></dt>
<dd><p><strong>idna</strong></p>
<p>Encodes the value per RFC 3490.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>val</strong> (<em>str</em>) – The string to encode</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Encoded string</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="resilient_lib.components.templates_common.iso8601">
<span class="sig-name descname"><span class="pre">iso8601</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">val</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#resilient_lib.components.templates_common.iso8601" title="Link to this definition">¶</a></dt>
<dd><p><strong>iso8601</strong></p>
<p>Assuming <code class="docutils literal notranslate"><span class="pre">val</span></code> is an epoch milliseconds timestamp, produce ISO8601 datetime.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>val</strong> (<em>str</em><em>|</em><em>int</em>) – An epoch milliseconds timestamp</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>ISO8601 datetime</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="resilient_lib.components.templates_common.js_filter">
<span class="sig-name descname"><span class="pre">js_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">val</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#resilient_lib.components.templates_common.js_filter" title="Link to this definition">¶</a></dt>
<dd><p><strong>js</strong></p>
<p>Produces JSONified string of the value,
without surrounding quotes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>val</strong> (<em>str</em>) – The string to convert</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>JSONified string of the value, without surrounding quotes</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="resilient_lib.components.templates_common.json_filter">
<span class="sig-name descname"><span class="pre">json_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">val</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#resilient_lib.components.templates_common.json_filter" title="Link to this definition">¶</a></dt>
<dd><p><strong>json</strong></p>
<p>Produces JSONified string of the value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>val</strong> (<em>str</em>) – The string to convert</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>JSONified string of the value</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="resilient_lib.components.templates_common.ldap_filter">
<span class="sig-name descname"><span class="pre">ldap_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">val</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#resilient_lib.components.templates_common.ldap_filter" title="Link to this definition">¶</a></dt>
<dd><p><strong>ldap</strong></p>
<p>Produces LDAP-encoded string of the value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>val</strong> (<em>str</em>) – The string to encode</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Encoded string</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="resilient_lib.components.templates_common.make_payload_from_template">
<span class="sig-name descname"><span class="pre">make_payload_from_template</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">template_override</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default_template</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">payload</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_json</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#resilient_lib.components.templates_common.make_payload_from_template" title="Link to this definition">¶</a></dt>
<dd><p>Convert a payload into a new format based on a specified template.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>template_override</strong> (<em>str</em>) – Path to the specified template (<em>usually
taken from the app.config file. See the Usage example above</em>)</p></li>
<li><p><strong>default_template</strong> (<em>str</em>) – Path to the default template (<em>usually in
the ‘/util/templates’ directory. See the Usage example above</em>)</p></li>
<li><p><strong>payload</strong> (<em>dict</em>) – <code class="docutils literal notranslate"><span class="pre">dict</span></code> of payload that is passed to Jinja template</p></li>
<li><p><strong>return_json</strong> (<em>bool</em>) – False if template should be render as a <code class="docutils literal notranslate"><span class="pre">str</span></code>
and results returned as a <code class="docutils literal notranslate"><span class="pre">str</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>If the Jinja template is valid JSON and <code class="docutils literal notranslate"><span class="pre">return_json</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code> the result is
returned as a <code class="docutils literal notranslate"><span class="pre">dict</span></code> else it returns the rendered template as a <code class="docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str|dict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – if <code class="docutils literal notranslate"><span class="pre">return_json</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code> and the Jinja template is not
valid JSON</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="resilient_lib.components.templates_common.pretty_filter">
<span class="sig-name descname"><span class="pre">pretty_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">val</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#resilient_lib.components.templates_common.pretty_filter" title="Link to this definition">¶</a></dt>
<dd><p><strong>pretty</strong></p>
<p>Produces pretty-printed string of the value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>val</strong> (<em>str</em>) – The string to format</p></li>
<li><p><strong>indent</strong> (<em>int</em>) – Number of tabs to use when formatting</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The formatted string</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="resilient_lib.components.templates_common.ps_filter">
<span class="sig-name descname"><span class="pre">ps_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">val</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#resilient_lib.components.templates_common.ps_filter" title="Link to this definition">¶</a></dt>
<dd><p><strong>ps</strong></p>
<p>Escapes characters in <code class="docutils literal notranslate"><span class="pre">val</span></code> for use in a PowerShell command line.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>val</strong> (<em>str</em>) – The string to escaped</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Escaped string</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="resilient_lib.components.templates_common.punycode_filter">
<span class="sig-name descname"><span class="pre">punycode_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">val</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#resilient_lib.components.templates_common.punycode_filter" title="Link to this definition">¶</a></dt>
<dd><p><strong>punycode</strong></p>
<p>Encodes the value per RFC 3492.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>val</strong> (<em>str</em>) – The string to encode</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Encoded string</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="resilient_lib.components.templates_common.render">
<span class="sig-name descname"><span class="pre">render</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">template</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#resilient_lib.components.templates_common.render" title="Link to this definition">¶</a></dt>
<dd><p>Render data into a template, producing a string result. All the additional custom filters are available.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>template</strong> (<em>str</em><em> or </em><em>dict</em>) – Path to or a dict of the Jinja template</p></li>
<li><p><strong>data</strong> (<em>dict</em>) – JSON data to apply to the template</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>result from the rendering of the template. The template is usually a string, but can be a dict</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str or dict</p>
</dd>
</dl>
<p><strong>Examples:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">render</span><span class="p">(</span><span class="s2">&quot;template {{value}}&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;value&quot;</span><span class="p">:</span><span class="s2">&quot;123&quot;</span><span class="p">})</span>
<span class="go">u&#39;template 123&#39;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">render</span><span class="p">({</span><span class="s2">&quot;template&quot;</span><span class="p">:</span> <span class="s2">&quot;{{value}}&quot;</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;value&quot;</span><span class="p">:</span><span class="s2">&quot;123&quot;</span><span class="p">})</span>
<span class="go">u&#39;{&quot;template&quot;: &quot;123&quot;}&#39;</span>

<span class="go">You can escape values using the &#39;json&#39; filter,</span>
<span class="go">or the &#39;url&#39; or &#39;html&#39; or &#39;ldap&#39; filters.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">render</span><span class="p">(</span><span class="s1">&#39;{&quot;template&quot;: {{value|json}} }&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;value&quot;</span><span class="p">:</span><span class="s1">&#39;1&quot;23&#39;</span><span class="p">})</span>
<span class="go">u&#39;{&quot;template&quot;: &quot;1\\&quot;23&quot; }&#39;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">render</span><span class="p">(</span><span class="s1">&#39;{&quot;template&quot;: &quot;{{value|js}}&quot; }&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;value&quot;</span><span class="p">:</span><span class="s1">&#39;1&quot;23&#39;</span><span class="p">})</span>
<span class="go">u&#39;{&quot;template&quot;: &quot;1\\&quot;23&quot; }&#39;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">render</span><span class="p">(</span><span class="s1">&#39;{&quot;template&quot;: {{value|ldap}} }&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;value&quot;</span><span class="p">:</span><span class="s1">&#39;1*23&#39;</span><span class="p">})</span>
<span class="go">u&#39;{&quot;template&quot;: 1\\2a23 }&#39;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">render</span><span class="p">(</span><span class="s1">&#39;shell &quot;{{value|ps}}&quot;&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;value&quot;</span><span class="p">:</span><span class="s1">&#39;$&quot;foo&quot;&#39;</span><span class="p">})</span>
<span class="go">u&#39;shell &quot;`$`&quot;foo`&quot;&quot;&#39;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">render</span><span class="p">(</span><span class="s1">&#39;shell &quot;{{value|sh}}&quot;&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;value&quot;</span><span class="p">:</span><span class="s1">&#39;$&quot;foo&quot;&#39;</span><span class="p">})</span>
<span class="go">u&#39;shell &quot;\\$\\&quot;foo\\&quot;&quot;&#39;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">render</span><span class="p">(</span><span class="s1">&#39;template={{value|timestamp}}&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;value&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">})</span>
<span class="go">u&#39;template=0&#39;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">render</span><span class="p">(</span><span class="s1">&#39;template={{value|timestamp}}&#39;</span><span class="p">,</span> <span class="p">{})</span>
<span class="go">u&#39;template=null&#39;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">render</span><span class="p">(</span><span class="s1">&#39;template={{value|timestamp}}&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;value&quot;</span><span class="p">:{</span><span class="s2">&quot;year&quot;</span><span class="p">:</span><span class="mi">2015</span><span class="p">,</span> <span class="s2">&quot;month&quot;</span><span class="p">:</span><span class="mi">7</span><span class="p">,</span> <span class="s2">&quot;day&quot;</span><span class="p">:</span><span class="mi">15</span><span class="p">}})</span>
<span class="go">u&#39;template=1436918400000&#39;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">render</span><span class="p">(</span><span class="s1">&#39;template={{value|timestamp}}&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;value&quot;</span><span class="p">:</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2015</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">15</span><span class="p">)})</span>
<span class="go">u&#39;template=1436918400000&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="resilient_lib.components.templates_common.render_json">
<span class="sig-name descname"><span class="pre">render_json</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">template</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#resilient_lib.components.templates_common.render_json" title="Link to this definition">¶</a></dt>
<dd><p>Render data into a template, producing a JSON result.
Also clean up any “really bad” control characters to avoid failure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>template</strong> (<em>str</em><em> or </em><em>dict</em>) – Path to or a dict of the Jinja template</p></li>
<li><p><strong>data</strong> (<em>dict</em>) – dict to apply to the template</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>result from the rendering of the template as a dictionary</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p><strong>Examples:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;the&quot;</span> <span class="o">+</span> <span class="nb">chr</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;new&quot;</span> <span class="o">+</span> <span class="nb">chr</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;thing&quot;</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">render_json</span><span class="p">(</span><span class="s1">&#39;{&quot;result&quot;:&quot;{{value}}&quot;}&#39;</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
<span class="go">{u&#39;result&#39;: u&#39;the new thing&#39;}</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;the&quot;</span> <span class="o">+</span> <span class="nb">chr</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;new&quot;</span> <span class="o">+</span> <span class="nb">chr</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;thing&quot;</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">render_json</span><span class="p">(</span><span class="s1">&#39;{&quot;result&quot;:&quot;{{value}}&quot;}&#39;</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
<span class="go">{u&#39;result&#39;: u&#39;the new thing&#39;}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="resilient_lib.components.templates_common.sample_filter">
<span class="sig-name descname"><span class="pre">sample_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">val</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">count</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#resilient_lib.components.templates_common.sample_filter" title="Link to this definition">¶</a></dt>
<dd><p><strong>sample</strong></p>
<p>Return a random sample from a list.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>val</strong> (<em>list</em>) – List of str | obj | int</p></li>
<li><p><strong>count</strong> (int | <code class="docutils literal notranslate"><span class="pre">None</span></code>) – Number of times to repeat items in <code class="docutils literal notranslate"><span class="pre">val</span></code> to
increase its <em>random</em> probability</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The random item</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str | obj | int</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="resilient_lib.components.templates_common.sh_filter">
<span class="sig-name descname"><span class="pre">sh_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">val</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#resilient_lib.components.templates_common.sh_filter" title="Link to this definition">¶</a></dt>
<dd><p><strong>sh</strong></p>
<p>Escapes characters in <code class="docutils literal notranslate"><span class="pre">val</span></code> for use in a Unix shell command line.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>val</strong> (<em>str</em>) – The string to escaped</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Escaped string</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="resilient_lib.components.templates_common.soar_datetimeformat">
<span class="sig-name descname"><span class="pre">soar_datetimeformat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">date_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'%Y-%m-%dT%H:%M:%S'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_at</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#resilient_lib.components.templates_common.soar_datetimeformat" title="Link to this definition">¶</a></dt>
<dd><p><strong>soar_datetimeformat</strong></p>
<p>Convert UTC dates to epoch format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>value</strong> (<em>str</em>) – The UTC date string</p></li>
<li><p><strong>date_format</strong> (<em>str</em>) – <em>(optional)</em> Conversion format. Defaults to <code class="docutils literal notranslate"><span class="pre">&quot;%Y-%m-%dT%H:%M:%S&quot;</span></code></p></li>
<li><p><strong>split_at</strong> (<em>str</em>) – <p><em>(optional)</em> Character to split the date field to scope the date field</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">split_at</span><span class="o">=</span><span class="s1">&#39;.&#39;</span> <span class="n">to</span> <span class="n">remove</span> <span class="n">milliseconds</span> <span class="k">for</span> <span class="s2">&quot;2021-10-22T20:53:53.913Z&quot;</span>
<span class="n">split_at</span><span class="o">=</span><span class="s1">&#39;+&#39;</span> <span class="n">to</span> <span class="n">remove</span> <span class="n">tz</span> <span class="n">information</span> <span class="s2">&quot;2021-10-22T20:53:53+00:00&quot;</span>
</pre></div>
</div>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Epoch value of datetime, in milliseconds</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="resilient_lib.components.templates_common.soar_splitpart">
<span class="sig-name descname"><span class="pre">soar_splitpart</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_chars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'</span> <span class="pre">-</span> <span class="pre">'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#resilient_lib.components.templates_common.soar_splitpart" title="Link to this definition">¶</a></dt>
<dd><p><strong>soar_splitpart</strong></p>
<p>Split a string and return the index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>value</strong> (<em>str</em>) – string to split</p></li>
<li><p><strong>index</strong> (<em>int</em>) – index of split to return</p></li>
<li><p><strong>split_chars</strong> (<em>str</em>) – <em>(optional)</em> split characters.  Defaults to <code class="docutils literal notranslate"><span class="pre">'</span> <span class="pre">-</span> <span class="pre">'</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>value of split. If <code class="docutils literal notranslate"><span class="pre">index</span></code> is out of bounds, the original <code class="docutils literal notranslate"><span class="pre">value</span></code> is returned</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="resilient_lib.components.templates_common.soar_substitute">
<span class="sig-name descname"><span class="pre">soar_substitute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">json_str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#resilient_lib.components.templates_common.soar_substitute" title="Link to this definition">¶</a></dt>
<dd><p><strong>soar_substitute</strong></p>
<p>Replace values based on a lookup dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>value</strong> (<em>str</em>) – original value to lookup</p></li>
<li><p><strong>json_str</strong> (<em>JSON encoded str</em>) – JSON encoded string with key/value pairs of lookup values</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>replacement value or original value if no replacement found</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str | int</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="resilient_lib.components.templates_common.soar_trimlist">
<span class="sig-name descname"><span class="pre">soar_trimlist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">org_list</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#resilient_lib.components.templates_common.soar_trimlist" title="Link to this definition">¶</a></dt>
<dd><p><strong>soar_trimlist</strong></p>
<p>Trim whitespace from elements in a list.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>org_list</strong> (<em>list</em><em> of </em><em>strings</em>) – list of elements to trim whitespace from</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>list with elements trimmed of whitespace</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="resilient_lib.components.templates_common.timestamp">
<span class="sig-name descname"><span class="pre">timestamp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">val</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#resilient_lib.components.templates_common.timestamp" title="Link to this definition">¶</a></dt>
<dd><p><strong>timestamp</strong></p>
<p>Try convert non-timestamp values to a timestamp.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>val</strong> (<em>str</em><em> | </em><em>dict</em>) – Either <code class="docutils literal notranslate"><span class="pre">&quot;now&quot;</span></code> or a dict containing year / month / day etc.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An epoch milliseconds timestamp</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">timestamp</span><span class="p">({</span><span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="mi">2018</span><span class="p">,</span> <span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span> <span class="s2">&quot;day&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;timezoneID&quot;</span><span class="p">:</span> <span class="s2">&quot;CET&quot;</span><span class="p">})</span>
<span class="go">1533078000000</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">timestamp</span><span class="p">(</span><span class="n">Undefined</span><span class="p">())</span>
<span class="go">&#39;null&#39;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">timestamp</span><span class="p">(</span><span class="s2">&quot;now&quot;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1530000000000</span>
<span class="go">True</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">timestamp</span><span class="p">(</span><span class="s2">&quot;now&quot;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2000000000000</span> <span class="c1"># 2033</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="resilient_lib.components.templates_common.uniq">
<span class="sig-name descname"><span class="pre">uniq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">val</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#resilient_lib.components.templates_common.uniq" title="Link to this definition">¶</a></dt>
<dd><p><strong>uniq</strong></p>
<p>Produce the unique list.  If <code class="docutils literal notranslate"><span class="pre">val</span></code> is a dict, produce unique list of key values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>val</strong> (<em>[</em><em>str</em><em> | </em><em>int</em><em> | </em><em>obj</em><em>]</em>) – The original list</p></li>
<li><p><strong>key</strong> (<em>str</em>) – If <code class="docutils literal notranslate"><span class="pre">val</span></code> is a dict return a list with dicts with just that <code class="docutils literal notranslate"><span class="pre">key</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Original list of items with duplicates removed</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">sorted</span><span class="p">(</span><span class="n">uniq</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">]))</span>
<span class="go">[1, 2, 3]</span>

<span class="gp">&gt;&gt;&gt; </span><span class="nb">sorted</span><span class="p">(</span><span class="n">uniq</span><span class="p">([</span> <span class="p">{</span><span class="s2">&quot;a&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;a&quot;</span><span class="p">:</span><span class="mi">2</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;a&quot;</span><span class="p">:</span><span class="mi">3</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;a&quot;</span><span class="p">:</span><span class="mi">2</span><span class="p">}]))</span>
<span class="go">[{&#39;a&#39;: 1}, {&#39;a&#39;: 2}, {&#39;a&#39;: 3}]</span>

<span class="gp">&gt;&gt;&gt; </span><span class="nb">sorted</span><span class="p">(</span><span class="n">uniq</span><span class="p">([</span> <span class="p">{</span><span class="s2">&quot;a&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;a&quot;</span><span class="p">:</span><span class="mi">2</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;a&quot;</span><span class="p">:</span><span class="mi">3</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;a&quot;</span><span class="p">:</span><span class="mi">2</span><span class="p">},</span> <span class="ne">Exception</span><span class="p">()],</span> <span class="s2">&quot;a&quot;</span><span class="p">))</span>
<span class="go">[{&#39;a&#39;: 1}, {&#39;a&#39;: 2}, {&#39;a&#39;: 3}, Exception()]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="resilient_lib.components.templates_common.url_filter">
<span class="sig-name descname"><span class="pre">url_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">val</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#resilient_lib.components.templates_common.url_filter" title="Link to this definition">¶</a></dt>
<dd><p><strong>url</strong></p>
<p>Produces URL-encoded string of the value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>val</strong> (<em>str</em>) – The string to encoded</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Encoded string</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="exceptions">
<h2>Exceptions<a class="headerlink" href="#exceptions" title="Link to this heading">¶</a></h2>
<dl class="py exception">
<dt class="sig sig-object py" id="resilient_lib.components.integration_errors.IntegrationError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">IntegrationError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#resilient_lib.components.integration_errors.IntegrationError" title="Link to this definition">¶</a></dt>
<dd><p>Class used to signal Integration Errors. It doesn’t add any specific information other than
identifying the type of error</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">resilient_lib</span> <span class="kn">import</span> <span class="n">IntegrationError</span>

<span class="k">raise</span> <span class="n">IntegrationError</span><span class="p">(</span><span class="s2">&quot;Example raising custom error&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="change-log">
<h2>Change Log<a class="headerlink" href="#change-log" title="Link to this heading">¶</a></h2>
<p><strong>2024-05: version 51.0.2.0</strong></p>
<ul class="simple">
<li><p>Added official support for Python 3.12</p></li>
</ul>
<p><strong>2024-04: version 51.0.1.1</strong></p>
<ul class="simple">
<li><p>No major changes. Just bumping build number to coincide with other builds</p></li>
</ul>
<p><strong>2024-02: version 51.0.1.0</strong></p>
<ul class="simple">
<li><p>All SOAR Python libraries now officially support Python 3.11</p></li>
<li><p>Updated <code class="docutils literal notranslate"><span class="pre">pytz</span></code> dependency requirement to <code class="docutils literal notranslate"><span class="pre">~=</span> <span class="pre">2024.1</span></code></p></li>
<li><p>Updated <code class="docutils literal notranslate"><span class="pre">jinja2</span></code> dependency requirement to <code class="docutils literal notranslate"><span class="pre">~=</span> <span class="pre">3.1</span></code> to address CVE-2024-22195</p></li>
</ul>
<p><strong>2024-01: version 51.0.0.2</strong></p>
<ul class="simple">
<li><p>Improve debug logs for retry parameters in <a class="reference internal" href="#resilient_lib.components.requests_common.RequestsCommon.execute" title="resilient_lib.components.requests_common.RequestsCommon.execute"><code class="xref py py-class docutils literal notranslate"><span class="pre">resilient_lib.RequestsCommon.execute()</span></code></a></p></li>
<li><p>Added internal UI components for HTML Blocks and Headers as well as Summary Section functionality</p></li>
</ul>
<p><strong>2023-11: version 51.0.0.0</strong></p>
<ul class="simple">
<li><p>Added optional retry to <a class="reference internal" href="#resilient_lib.components.requests_common.RequestsCommon.execute" title="resilient_lib.components.requests_common.RequestsCommon.execute"><code class="xref py py-class docutils literal notranslate"><span class="pre">resilient_lib.RequestsCommon.execute()</span></code></a>.
This allows developers to control the retry behavior of failed requests. See
<a class="reference internal" href="#resilient_lib.components.requests_common.RequestsCommon.execute" title="resilient_lib.components.requests_common.RequestsCommon.execute"><code class="xref py py-class docutils literal notranslate"><span class="pre">resilient_lib.RequestsCommon.execute()</span></code></a> for more details and examples</p></li>
</ul>
<p><strong>2023-10: version 50.1</strong></p>
<ul class="simple">
<li><p>Unit test improvements to better handle flaky <code class="docutils literal notranslate"><span class="pre">requests</span></code> tests</p></li>
</ul>
<p><strong>2023-08: version 50.0</strong></p>
<ul class="simple">
<li><p>No major changes. Just bumping build number to coincide with other builds</p></li>
</ul>
<p><strong>2023-07: version 49.1</strong></p>
<ul class="simple">
<li><p>No major changes. Just bumping build number to coincide with other builds</p></li>
</ul>
<p><strong>2023-05: version 49.0</strong></p>
<ul class="simple">
<li><p>Added new functions for pollers to interact with SOAR</p></li>
</ul>
<p><strong>2023-04: version 48.1</strong></p>
<ul class="simple">
<li><p>Updated SOAR case default filters for poller helper methods</p></li>
</ul>
<p><strong>2023-02: version 48.0</strong></p>
<ul>
<li><p>Added support for <code class="docutils literal notranslate"><span class="pre">verify</span></code> config in app.config when using
<a class="reference internal" href="#resilient_lib.components.requests_common.RequestsCommon.execute" title="resilient_lib.components.requests_common.RequestsCommon.execute"><code class="xref py py-class docutils literal notranslate"><span class="pre">resilient_lib.RequestsCommon.execute()</span></code></a>.
<code class="docutils literal notranslate"><span class="pre">verify</span></code> now can be set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, <code class="docutils literal notranslate"><span class="pre">False</span></code>, or <code class="docutils literal notranslate"><span class="pre">&lt;path_to_your_custom_CA_bundle&gt;</span></code> to control the value used
when verifying SSL certificates. This change is backward compatible with any apps that use <code class="docutils literal notranslate"><span class="pre">RequestsCommon.execute()</span></code>
so any apps updated to run on v48.0 will pull in these changes and the <code class="docutils literal notranslate"><span class="pre">verify</span></code> configuration will be supported for that app</p></li>
<li><p>Updated <a class="reference internal" href="#resilient_lib.components.requests_common.RequestsCommon" title="resilient_lib.components.requests_common.RequestsCommon"><code class="xref py py-class docutils literal notranslate"><span class="pre">resilient_lib.RequestsCommon</span></code></a> to take advantage
of persistent sessions from the <code class="docutils literal notranslate"><span class="pre">requests</span></code> library using <code class="docutils literal notranslate"><span class="pre">requests.Session()</span></code>. This has multiple advantages,
including cookies persisting from the endpoint and significant performance increases when connecting to the same host.
If non-session objects are desired, switch your code to use the new class
<a class="reference internal" href="#resilient_lib.components.requests_common.RequestsCommonWithoutSession" title="resilient_lib.components.requests_common.RequestsCommonWithoutSession"><code class="xref py py-class docutils literal notranslate"><span class="pre">resilient_lib.RequestsCommonWithoutSession</span></code></a>
which behaves the same as the old <code class="docutils literal notranslate"><span class="pre">RequestsCommon</span></code> would</p></li>
<li><p>Updated project to use <code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code> and <code class="docutils literal notranslate"><span class="pre">setup.cfg</span></code> metadata files. Build backend continues to use <code class="docutils literal notranslate"><span class="pre">setuptools</span></code>.
Instead of directly invoking setup.py to get a sdist or wheel, use <code class="docutils literal notranslate"><span class="pre">build</span></code> as a build frontend:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>build
python<span class="w"> </span>-m<span class="w"> </span>build
</pre></div>
</div>
</li>
</ul>
<p><strong>2022-12: version 47.1</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="#resilient_lib.components.requests_common.RequestsCommon.get_client_auth" title="resilient_lib.components.requests_common.RequestsCommon.get_client_auth"><code class="xref py py-class docutils literal notranslate"><span class="pre">resilient_lib.RequestsCommon.get_client_auth()</span></code></a> renamed from <code class="docutils literal notranslate"><span class="pre">get_clientauth</span></code>. Alias provided for <code class="docutils literal notranslate"><span class="pre">get_clientauth</span></code> for backward compatiblity. Please use <a class="reference internal" href="#resilient_lib.components.requests_common.RequestsCommon.get_client_auth" title="resilient_lib.components.requests_common.RequestsCommon.get_client_auth"><code class="xref py py-class docutils literal notranslate"><span class="pre">get_client_auth()</span></code></a> from now on</p></li>
</ul>
<p><strong>2022-11: version 47.0</strong></p>
<ul class="simple">
<li><p>Support for poller-based apps added with new <a class="reference internal" href="#common-poller-methods">Common Poller Methods</a>,
including <code class="docutils literal notranslate"><span class="pre">resilient_lib.poller()</span></code> decorator and <code class="docutils literal notranslate"><span class="pre">resilient_lib.SOARCommon</span></code>
class of common SOAR methods</p></li>
</ul>
<p><strong>2022-08: version 46.0</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">build_incident_url</span></code> urlencodes it’s <code class="docutils literal notranslate"><span class="pre">orgId</span></code></p></li>
</ul>
<p><strong>2022-07: version 45.1</strong></p>
<ul class="simple">
<li><p>No major changes. Just bumping build number to coincide with other builds</p></li>
</ul>
<p><strong>2022-05: version 45.0</strong></p>
<ul class="simple">
<li><p>Added <code class="docutils literal notranslate"><span class="pre">build_task_url</span></code> to build direct links to incident Tasks</p></li>
<li><p>Updated <code class="docutils literal notranslate"><span class="pre">build_incident_url</span></code> to support appending Organization ID queries</p></li>
<li><p>Added <code class="docutils literal notranslate"><span class="pre">client_auth_cert</span></code> and <code class="docutils literal notranslate"><span class="pre">client_auth_key</span></code> options for client side certificates.
These can be specified per app in the relevant [fn_some_app] section of the app.config
and will be used in any requests made through <code class="docutils literal notranslate"><span class="pre">resilient_lib.RequestsCommon</span></code>.</p></li>
</ul>
<p><strong>2022-04: version 44.1</strong></p>
<ul class="simple">
<li><p>Added <a class="reference internal" href="#common-jinja-methods">Common Jinja Methods</a> for help with using Jinja in your App</p></li>
</ul>
<p><strong>2022-02: version 44.0</strong></p>
<ul class="simple">
<li><p>Ensure <code class="docutils literal notranslate"><span class="pre">tests/</span></code> is not included in packaged code</p></li>
<li><p>Officially support <code class="docutils literal notranslate"><span class="pre">Python</span> <span class="pre">3.9</span></code></p></li>
</ul>
<p><strong>2022-01: version 43.1</strong></p>
<ul class="simple">
<li><p>No major changes. Just bumping build number to coincide with other builds</p></li>
</ul>
<p><strong>2021-11: version 43.0</strong></p>
<ul class="simple">
<li><p>Formatted Sphinx documentation and hosted it at <a class="reference external" href="https://ibm.biz/soar-python-docs">https://ibm.biz/soar-python-docs</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">validate_fields</span></code> also handles a <code class="docutils literal notranslate"><span class="pre">namedtuple</span></code></p></li>
</ul>
<p><strong>2021-11: version 42.3</strong></p>
<ul class="simple">
<li><p>No major changes. Just bumping build number to coincide with other builds</p></li>
</ul>
<p><strong>2021-10: version 42.2</strong></p>
<ul class="simple">
<li><p>No major changes. Just bumping build number to coincide with other builds</p></li>
</ul>
<p><strong>2021-08: version 42.1</strong></p>
<ul class="simple">
<li><p>No major changes. Just bumping build number to coincide with other builds</p></li>
</ul>
<p><strong>2021-08: version 42.0</strong></p>
<ul class="simple">
<li><p>Added support for <code class="docutils literal notranslate"><span class="pre">HTTP_PROXY</span></code>, <code class="docutils literal notranslate"><span class="pre">HTTPS_PROXY</span></code> and <code class="docutils literal notranslate"><span class="pre">NO_PROXY</span></code> environmental variables. See the App Host Deployment Guide for details.</p></li>
<li><p>Fix to OAuth2 to avoid infinite loop in some circumstances.</p></li>
</ul>
<p><strong>2021-06: version 41.1</strong></p>
<ul class="simple">
<li><p>Added <code class="docutils literal notranslate"><span class="pre">execute</span></code> as an alias for <code class="docutils literal notranslate"><span class="pre">execute_call_v2</span></code></p></li>
<li><p>Bug fixes</p></li>
</ul>
<p><strong>2021-05: version 41.0</strong></p>
<ul class="simple">
<li><p>No major changes. Just bumping build number to coincide with other builds</p></li>
</ul>
<p><strong>2021-03: version 40.2</strong></p>
<ul class="simple">
<li><p>Bug fix for to use <code class="docutils literal notranslate"><span class="pre">setuptools_scm</span> <span class="pre">&lt;</span> <span class="pre">6.0.0</span></code> for Python 2.7 environments</p></li>
</ul>
<p><strong>2021-03: version 40.1</strong></p>
<ul class="simple">
<li><p>No major changes. Just bumping build number to coincide with other builds</p></li>
</ul>
<p><strong>2021-02: version 40.0</strong></p>
<ul class="simple">
<li><p>bug fixes</p></li>
</ul>
<p><strong>2020-12: version 39</strong></p>
<ul class="simple">
<li><p>add a capability to close an incident</p></li>
<li><p>fixes a bug where timeout defined in function section is not processed as an int</p></li>
</ul>
<p><strong>2020-09: version 38</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">validate_fields</span></code> now handles a field if it’s type is <strong>Text with value string</strong></p></li>
</ul>
<p><strong>2020-05: version 37</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">execute_call_v2</span></code></p></li>
<li><p>might give an error when debugging with PyCharm. Added a workaround in a comment above the line where it occurs.</p></li>
</ul>
<p><strong>2020-04: version 36.2.dev</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">execute_call_v2</span></code> might give an error when debugging with PyCharm. Added a workaround in a comment above the line where it occurs.</p></li>
</ul>
<p><strong>2020-01-16: version 35.0.195</strong></p>
<ul class="simple">
<li><p>Added OAuth2 Client Credentials workflow handler</p></li>
<li><p>Added support for timeout argument in integrations config section</p></li>
</ul>
<p><strong>2019-10-07: version 34.0.194</strong></p>
<ul class="simple">
<li><p>Add functionality to resilient_lib to upload attachment</p></li>
<li><p>Added support for a timeout parameter across all integrations using the <code class="docutils literal notranslate"><span class="pre">execute_call_v2()</span></code> function</p></li>
</ul>
<p><strong>2019-08-02: version 33.0.189</strong></p>
<ul class="simple">
<li><p>Added support for API key and API key secret, now able to authenticate
using API keys instead of email/password</p></li>
<li><dl class="simple">
<dt>New functions added to <code class="docutils literal notranslate"><span class="pre">resilient-lib</span></code></dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">get_file_attachment_metadata()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">write_to_tmp_file()</span></code></p></li>
</ul>
</dd>
</dl>
</li>
<li><p>Updated <code class="docutils literal notranslate"><span class="pre">validate_fields()</span></code> function in <code class="docutils literal notranslate"><span class="pre">resilient-lib</span></code>,
adding the ability to validate fields in app.config</p></li>
<li><p>Other minor bug fixes.</p></li>
</ul>
<p><strong>2019-07-03: version 32.0.186</strong></p>
<ul class="simple">
<li><p>Added more flexible <code class="docutils literal notranslate"><span class="pre">execute_call_v2()</span></code> method in <code class="docutils literal notranslate"><span class="pre">resilient-lib</span></code></p></li>
<li><p>Fix for deprecated log warnings</p></li>
<li><p>Other minor bug fixes</p></li>
</ul>
<p><strong>2019-04-12: version 32.0.140</strong></p>
<ul class="simple">
<li><p>Improvements to <code class="docutils literal notranslate"><span class="pre">resilient-lib</span></code></p></li>
<li><p>Other minor bug fixes/improvements</p></li>
</ul>
<p><strong>2019-03-06: version 32.0.126</strong></p>
<ul class="simple">
<li><p>Removed <code class="docutils literal notranslate"><span class="pre">selftest</span></code> from function template</p></li>
<li><p>Improvements to <code class="docutils literal notranslate"><span class="pre">resilient-lib</span></code></p></li>
</ul>
<p><strong>2019-01-15: version 32.0</strong></p>
<ul class="simple">
<li><p>Added <code class="docutils literal notranslate"><span class="pre">resilient-lib</span></code> to repo and PyPi - common library calls which facilitate the development of functions for IBM Resilient</p></li>
<li><p>Added Sphinx documentation builder</p></li>
</ul>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../resilient-sdk/resilient-sdk.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">resilient-sdk</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../resilient-circuits/resilient-circuits.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">resilient-circuits</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2023, IBM
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">resilient-lib</a><ul>
<li><a class="reference internal" href="#usage">Usage</a></li>
<li><a class="reference internal" href="#proxies">Proxies</a></li>
<li><a class="reference internal" href="#certificate-verification">Certificate Verification</a></li>
<li><a class="reference internal" href="#module-resilient_lib.components.resilient_common">Common Helper Methods</a><ul>
<li><a class="reference internal" href="#resilient_lib.components.resilient_common.build_incident_url"><code class="docutils literal notranslate"><span class="pre">build_incident_url()</span></code></a></li>
<li><a class="reference internal" href="#resilient_lib.components.resilient_common.build_resilient_url"><code class="docutils literal notranslate"><span class="pre">build_resilient_url()</span></code></a></li>
<li><a class="reference internal" href="#resilient_lib.components.resilient_common.build_task_url"><code class="docutils literal notranslate"><span class="pre">build_task_url()</span></code></a></li>
<li><a class="reference internal" href="#resilient_lib.components.resilient_common.clean_html"><code class="docutils literal notranslate"><span class="pre">clean_html()</span></code></a></li>
<li><a class="reference internal" href="#resilient_lib.components.resilient_common.close_incident"><code class="docutils literal notranslate"><span class="pre">close_incident()</span></code></a></li>
<li><a class="reference internal" href="#resilient_lib.components.resilient_common.get_file_attachment"><code class="docutils literal notranslate"><span class="pre">get_file_attachment()</span></code></a></li>
<li><a class="reference internal" href="#resilient_lib.components.resilient_common.get_file_attachment_metadata"><code class="docutils literal notranslate"><span class="pre">get_file_attachment_metadata()</span></code></a></li>
<li><a class="reference internal" href="#resilient_lib.components.resilient_common.get_file_attachment_name"><code class="docutils literal notranslate"><span class="pre">get_file_attachment_name()</span></code></a></li>
<li><a class="reference internal" href="#resilient_lib.components.resilient_common.readable_datetime"><code class="docutils literal notranslate"><span class="pre">readable_datetime()</span></code></a></li>
<li><a class="reference internal" href="#resilient_lib.components.resilient_common.str_to_bool"><code class="docutils literal notranslate"><span class="pre">str_to_bool()</span></code></a></li>
<li><a class="reference internal" href="#resilient_lib.components.resilient_common.unescape"><code class="docutils literal notranslate"><span class="pre">unescape()</span></code></a></li>
<li><a class="reference internal" href="#resilient_lib.components.resilient_common.validate_fields"><code class="docutils literal notranslate"><span class="pre">validate_fields()</span></code></a></li>
<li><a class="reference internal" href="#resilient_lib.components.resilient_common.write_file_attachment"><code class="docutils literal notranslate"><span class="pre">write_file_attachment()</span></code></a></li>
<li><a class="reference internal" href="#resilient_lib.components.resilient_common.write_to_tmp_file"><code class="docutils literal notranslate"><span class="pre">write_to_tmp_file()</span></code></a></li>
<li><a class="reference internal" href="#resilient_lib.components.html2markdown.MarkdownParser"><code class="docutils literal notranslate"><span class="pre">MarkdownParser</span></code></a><ul>
<li><a class="reference internal" href="#resilient_lib.components.html2markdown.MarkdownParser.convert"><code class="docutils literal notranslate"><span class="pre">MarkdownParser.convert()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#resilient_lib.components.oauth2_client_credentials_session.OAuth2ClientCredentialsSession"><code class="docutils literal notranslate"><span class="pre">OAuth2ClientCredentialsSession</span></code></a><ul>
<li><a class="reference internal" href="#resilient_lib.components.oauth2_client_credentials_session.OAuth2ClientCredentialsSession.add_authorization_header"><code class="docutils literal notranslate"><span class="pre">OAuth2ClientCredentialsSession.add_authorization_header()</span></code></a></li>
<li><a class="reference internal" href="#resilient_lib.components.oauth2_client_credentials_session.OAuth2ClientCredentialsSession.authenticate"><code class="docutils literal notranslate"><span class="pre">OAuth2ClientCredentialsSession.authenticate()</span></code></a></li>
<li><a class="reference internal" href="#resilient_lib.components.oauth2_client_credentials_session.OAuth2ClientCredentialsSession.get_token"><code class="docutils literal notranslate"><span class="pre">OAuth2ClientCredentialsSession.get_token()</span></code></a></li>
<li><a class="reference internal" href="#resilient_lib.components.oauth2_client_credentials_session.OAuth2ClientCredentialsSession.request"><code class="docutils literal notranslate"><span class="pre">OAuth2ClientCredentialsSession.request()</span></code></a></li>
<li><a class="reference internal" href="#resilient_lib.components.oauth2_client_credentials_session.OAuth2ClientCredentialsSession.update_token"><code class="docutils literal notranslate"><span class="pre">OAuth2ClientCredentialsSession.update_token()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#common-request-methods">Common Request Methods</a><ul>
<li><a class="reference internal" href="#resilient_lib.components.requests_common.RequestsCommon"><code class="docutils literal notranslate"><span class="pre">RequestsCommon</span></code></a><ul>
<li><a class="reference internal" href="#resilient_lib.components.requests_common.RequestsCommon.execute"><code class="docutils literal notranslate"><span class="pre">RequestsCommon.execute()</span></code></a></li>
<li><a class="reference internal" href="#resilient_lib.components.requests_common.RequestsCommon.get_proxies"><code class="docutils literal notranslate"><span class="pre">RequestsCommon.get_proxies()</span></code></a></li>
<li><a class="reference internal" href="#resilient_lib.components.requests_common.RequestsCommon.get_verify"><code class="docutils literal notranslate"><span class="pre">RequestsCommon.get_verify()</span></code></a></li>
<li><a class="reference internal" href="#resilient_lib.components.requests_common.RequestsCommon.get_client_auth"><code class="docutils literal notranslate"><span class="pre">RequestsCommon.get_client_auth()</span></code></a></li>
<li><a class="reference internal" href="#resilient_lib.components.requests_common.RequestsCommon.get_timeout"><code class="docutils literal notranslate"><span class="pre">RequestsCommon.get_timeout()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#resilient_lib.components.requests_common.RequestsCommonWithoutSession"><code class="docutils literal notranslate"><span class="pre">RequestsCommonWithoutSession</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#common-poller-methods">Common Poller Methods</a><ul>
<li><a class="reference internal" href="#resilient_lib.components.poller_common.poller"><code class="docutils literal notranslate"><span class="pre">poller()</span></code></a></li>
<li><a class="reference internal" href="#resilient_lib.components.poller_common.SOARCommon"><code class="docutils literal notranslate"><span class="pre">SOARCommon</span></code></a><ul>
<li><a class="reference internal" href="#resilient_lib.components.poller_common.SOARCommon.create_case_comment"><code class="docutils literal notranslate"><span class="pre">SOARCommon.create_case_comment()</span></code></a></li>
<li><a class="reference internal" href="#resilient_lib.components.poller_common.SOARCommon.create_datatable_row"><code class="docutils literal notranslate"><span class="pre">SOARCommon.create_datatable_row()</span></code></a></li>
<li><a class="reference internal" href="#resilient_lib.components.poller_common.SOARCommon.create_soar_case"><code class="docutils literal notranslate"><span class="pre">SOARCommon.create_soar_case()</span></code></a></li>
<li><a class="reference internal" href="#resilient_lib.components.poller_common.SOARCommon.filter_soar_comments"><code class="docutils literal notranslate"><span class="pre">SOARCommon.filter_soar_comments()</span></code></a></li>
<li><a class="reference internal" href="#resilient_lib.components.poller_common.SOARCommon.get_case"><code class="docutils literal notranslate"><span class="pre">SOARCommon.get_case()</span></code></a></li>
<li><a class="reference internal" href="#resilient_lib.components.poller_common.SOARCommon.get_case_artifacts"><code class="docutils literal notranslate"><span class="pre">SOARCommon.get_case_artifacts()</span></code></a></li>
<li><a class="reference internal" href="#resilient_lib.components.poller_common.SOARCommon.get_case_attachment"><code class="docutils literal notranslate"><span class="pre">SOARCommon.get_case_attachment()</span></code></a></li>
<li><a class="reference internal" href="#resilient_lib.components.poller_common.SOARCommon.get_case_attachments"><code class="docutils literal notranslate"><span class="pre">SOARCommon.get_case_attachments()</span></code></a></li>
<li><a class="reference internal" href="#resilient_lib.components.poller_common.SOARCommon.get_case_comments"><code class="docutils literal notranslate"><span class="pre">SOARCommon.get_case_comments()</span></code></a></li>
<li><a class="reference internal" href="#resilient_lib.components.poller_common.SOARCommon.get_case_tasks"><code class="docutils literal notranslate"><span class="pre">SOARCommon.get_case_tasks()</span></code></a></li>
<li><a class="reference internal" href="#resilient_lib.components.poller_common.SOARCommon.get_soar_case"><code class="docutils literal notranslate"><span class="pre">SOARCommon.get_soar_case()</span></code></a></li>
<li><a class="reference internal" href="#resilient_lib.components.poller_common.SOARCommon.get_soar_cases"><code class="docutils literal notranslate"><span class="pre">SOARCommon.get_soar_cases()</span></code></a></li>
<li><a class="reference internal" href="#resilient_lib.components.poller_common.SOARCommon.lookup_artifact_type"><code class="docutils literal notranslate"><span class="pre">SOARCommon.lookup_artifact_type()</span></code></a></li>
<li><a class="reference internal" href="#resilient_lib.components.poller_common.SOARCommon.lookup_incident_types"><code class="docutils literal notranslate"><span class="pre">SOARCommon.lookup_incident_types()</span></code></a></li>
<li><a class="reference internal" href="#resilient_lib.components.poller_common.SOARCommon.update_soar_case"><code class="docutils literal notranslate"><span class="pre">SOARCommon.update_soar_case()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#resilient_lib.components.poller_common.eval_mapping"><code class="docutils literal notranslate"><span class="pre">eval_mapping()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-resilient_lib.components.templates_common">Common Jinja Methods</a><ul>
<li><a class="reference internal" href="#resilient_lib.components.templates_common.base64_filter"><code class="docutils literal notranslate"><span class="pre">base64_filter()</span></code></a></li>
<li><a class="reference internal" href="#resilient_lib.components.templates_common.camel_filter"><code class="docutils literal notranslate"><span class="pre">camel_filter()</span></code></a></li>
<li><a class="reference internal" href="#resilient_lib.components.templates_common.global_jinja_env"><code class="docutils literal notranslate"><span class="pre">global_jinja_env()</span></code></a></li>
<li><a class="reference internal" href="#resilient_lib.components.templates_common.html_filter"><code class="docutils literal notranslate"><span class="pre">html_filter()</span></code></a></li>
<li><a class="reference internal" href="#resilient_lib.components.templates_common.idna_filter"><code class="docutils literal notranslate"><span class="pre">idna_filter()</span></code></a></li>
<li><a class="reference internal" href="#resilient_lib.components.templates_common.iso8601"><code class="docutils literal notranslate"><span class="pre">iso8601()</span></code></a></li>
<li><a class="reference internal" href="#resilient_lib.components.templates_common.js_filter"><code class="docutils literal notranslate"><span class="pre">js_filter()</span></code></a></li>
<li><a class="reference internal" href="#resilient_lib.components.templates_common.json_filter"><code class="docutils literal notranslate"><span class="pre">json_filter()</span></code></a></li>
<li><a class="reference internal" href="#resilient_lib.components.templates_common.ldap_filter"><code class="docutils literal notranslate"><span class="pre">ldap_filter()</span></code></a></li>
<li><a class="reference internal" href="#resilient_lib.components.templates_common.make_payload_from_template"><code class="docutils literal notranslate"><span class="pre">make_payload_from_template()</span></code></a></li>
<li><a class="reference internal" href="#resilient_lib.components.templates_common.pretty_filter"><code class="docutils literal notranslate"><span class="pre">pretty_filter()</span></code></a></li>
<li><a class="reference internal" href="#resilient_lib.components.templates_common.ps_filter"><code class="docutils literal notranslate"><span class="pre">ps_filter()</span></code></a></li>
<li><a class="reference internal" href="#resilient_lib.components.templates_common.punycode_filter"><code class="docutils literal notranslate"><span class="pre">punycode_filter()</span></code></a></li>
<li><a class="reference internal" href="#resilient_lib.components.templates_common.render"><code class="docutils literal notranslate"><span class="pre">render()</span></code></a></li>
<li><a class="reference internal" href="#resilient_lib.components.templates_common.render_json"><code class="docutils literal notranslate"><span class="pre">render_json()</span></code></a></li>
<li><a class="reference internal" href="#resilient_lib.components.templates_common.sample_filter"><code class="docutils literal notranslate"><span class="pre">sample_filter()</span></code></a></li>
<li><a class="reference internal" href="#resilient_lib.components.templates_common.sh_filter"><code class="docutils literal notranslate"><span class="pre">sh_filter()</span></code></a></li>
<li><a class="reference internal" href="#resilient_lib.components.templates_common.soar_datetimeformat"><code class="docutils literal notranslate"><span class="pre">soar_datetimeformat()</span></code></a></li>
<li><a class="reference internal" href="#resilient_lib.components.templates_common.soar_splitpart"><code class="docutils literal notranslate"><span class="pre">soar_splitpart()</span></code></a></li>
<li><a class="reference internal" href="#resilient_lib.components.templates_common.soar_substitute"><code class="docutils literal notranslate"><span class="pre">soar_substitute()</span></code></a></li>
<li><a class="reference internal" href="#resilient_lib.components.templates_common.soar_trimlist"><code class="docutils literal notranslate"><span class="pre">soar_trimlist()</span></code></a></li>
<li><a class="reference internal" href="#resilient_lib.components.templates_common.timestamp"><code class="docutils literal notranslate"><span class="pre">timestamp()</span></code></a></li>
<li><a class="reference internal" href="#resilient_lib.components.templates_common.uniq"><code class="docutils literal notranslate"><span class="pre">uniq()</span></code></a></li>
<li><a class="reference internal" href="#resilient_lib.components.templates_common.url_filter"><code class="docutils literal notranslate"><span class="pre">url_filter()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#exceptions">Exceptions</a><ul>
<li><a class="reference internal" href="#resilient_lib.components.integration_errors.IntegrationError"><code class="docutils literal notranslate"><span class="pre">IntegrationError</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#change-log">Change Log</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../_static/documentation_options.js?v=9a347e77"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/scripts/furo.js?v=4e2eecee"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=a56c686a"></script>
    </body>
</html>